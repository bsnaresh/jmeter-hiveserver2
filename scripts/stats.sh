hive="bash -x /grid/1/jmeter-hiveserver2/bl.sh --format tsv "
hive="./dist/hive/bin/hive --service cli"
$hive -e 'select map("wp_web_page_sk_ndv", compute_stats(wp_web_page_sk, 20).numdistinctvalues),map("wp_web_page_id_ndv", compute_stats(wp_web_page_id, 20).numdistinctvalues),map("wp_rec_start_date_ndv", compute_stats(wp_rec_start_date, 20).numdistinctvalues),map("wp_rec_end_date_ndv", compute_stats(wp_rec_end_date, 20).numdistinctvalues),map("wp_creation_date_sk_ndv", compute_stats(wp_creation_date_sk, 20).numdistinctvalues),map("wp_access_date_sk_ndv", compute_stats(wp_access_date_sk, 20).numdistinctvalues),map("wp_autogen_flag_ndv", compute_stats(wp_autogen_flag, 20).numdistinctvalues),map("wp_customer_sk_ndv", compute_stats(wp_customer_sk, 20).numdistinctvalues),map("wp_url_ndv", compute_stats(wp_url, 20).numdistinctvalues),map("wp_type_ndv", compute_stats(wp_type, 20).numdistinctvalues),map("wp_char_count_ndv", compute_stats(wp_char_count, 20).numdistinctvalues),map("wp_link_count_ndv", compute_stats(wp_link_count, 20).numdistinctvalues),map("wp_image_count_ndv", compute_stats(wp_image_count, 20).numdistinctvalues),map("wp_max_ad_count_ndv", compute_stats(wp_max_ad_count, 20).numdistinctvalues) from web_page' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/web_page.txt
$hive -e 'select map("ib_income_band_sk_ndv", compute_stats(ib_income_band_sk, 20).numdistinctvalues),map("ib_lower_bound_ndv", compute_stats(ib_lower_bound, 20).numdistinctvalues),map("ib_upper_bound_ndv", compute_stats(ib_upper_bound, 20).numdistinctvalues) from income_band' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/income_band.txt
$hive -e 'select map("sm_ship_mode_sk_ndv", compute_stats(sm_ship_mode_sk, 20).numdistinctvalues),map("sm_ship_mode_id_ndv", compute_stats(sm_ship_mode_id, 20).numdistinctvalues),map("sm_type_ndv", compute_stats(sm_type, 20).numdistinctvalues),map("sm_code_ndv", compute_stats(sm_code, 20).numdistinctvalues),map("sm_carrier_ndv", compute_stats(sm_carrier, 20).numdistinctvalues),map("sm_contract_ndv", compute_stats(sm_contract, 20).numdistinctvalues) from ship_mode' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/ship_mode.txt
$hive -e 'select map("ws_sold_time_sk_ndv", compute_stats(ws_sold_time_sk, 20).numdistinctvalues),map("ws_ship_date_sk_ndv", compute_stats(ws_ship_date_sk, 20).numdistinctvalues),map("ws_item_sk_ndv", compute_stats(ws_item_sk, 20).numdistinctvalues),map("ws_bill_customer_sk_ndv", compute_stats(ws_bill_customer_sk, 20).numdistinctvalues),map("ws_bill_cdemo_sk_ndv", compute_stats(ws_bill_cdemo_sk, 20).numdistinctvalues),map("ws_bill_hdemo_sk_ndv", compute_stats(ws_bill_hdemo_sk, 20).numdistinctvalues),map("ws_bill_addr_sk_ndv", compute_stats(ws_bill_addr_sk, 20).numdistinctvalues),map("ws_ship_customer_sk_ndv", compute_stats(ws_ship_customer_sk, 20).numdistinctvalues),map("ws_ship_cdemo_sk_ndv", compute_stats(ws_ship_cdemo_sk, 20).numdistinctvalues),map("ws_ship_hdemo_sk_ndv", compute_stats(ws_ship_hdemo_sk, 20).numdistinctvalues),map("ws_ship_addr_sk_ndv", compute_stats(ws_ship_addr_sk, 20).numdistinctvalues),map("ws_web_page_sk_ndv", compute_stats(ws_web_page_sk, 20).numdistinctvalues),map("ws_web_site_sk_ndv", compute_stats(ws_web_site_sk, 20).numdistinctvalues),map("ws_ship_mode_sk_ndv", compute_stats(ws_ship_mode_sk, 20).numdistinctvalues),map("ws_warehouse_sk_ndv", compute_stats(ws_warehouse_sk, 20).numdistinctvalues),map("ws_promo_sk_ndv", compute_stats(ws_promo_sk, 20).numdistinctvalues),map("ws_order_number_ndv", compute_stats(ws_order_number, 20).numdistinctvalues),map("ws_quantity_ndv", compute_stats(ws_quantity, 20).numdistinctvalues),map("ws_wholesale_cost_ndv", compute_stats(ws_wholesale_cost, 20).numdistinctvalues),map("ws_list_price_ndv", compute_stats(ws_list_price, 20).numdistinctvalues),map("ws_sales_price_ndv", compute_stats(ws_sales_price, 20).numdistinctvalues),map("ws_ext_discount_amt_ndv", compute_stats(ws_ext_discount_amt, 20).numdistinctvalues),map("ws_ext_sales_price_ndv", compute_stats(ws_ext_sales_price, 20).numdistinctvalues),map("ws_ext_wholesale_cost_ndv", compute_stats(ws_ext_wholesale_cost, 20).numdistinctvalues),map("ws_ext_list_price_ndv", compute_stats(ws_ext_list_price, 20).numdistinctvalues),map("ws_ext_tax_ndv", compute_stats(ws_ext_tax, 20).numdistinctvalues),map("ws_coupon_amt_ndv", compute_stats(ws_coupon_amt, 20).numdistinctvalues),map("ws_ext_ship_cost_ndv", compute_stats(ws_ext_ship_cost, 20).numdistinctvalues),map("ws_net_paid_ndv", compute_stats(ws_net_paid, 20).numdistinctvalues),map("ws_net_paid_inc_tax_ndv", compute_stats(ws_net_paid_inc_tax, 20).numdistinctvalues),map("ws_net_paid_inc_ship_ndv", compute_stats(ws_net_paid_inc_ship, 20).numdistinctvalues),map("ws_net_paid_inc_ship_tax_ndv", compute_stats(ws_net_paid_inc_ship_tax, 20).numdistinctvalues),map("ws_net_profit_ndv", compute_stats(ws_net_profit, 20).numdistinctvalues),map("ws_sold_date_sk_ndv", compute_stats(ws_sold_date_sk, 20).numdistinctvalues),map("ws_sold_date_sk_ndv", compute_stats(ws_sold_date_sk, 20).numdistinctvalues) from web_sales' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/web_sales.txt
$hive -e 'select map("ws_sold_time_sk_ndv", compute_stats(ws_sold_time_sk, 20).numdistinctvalues),map("ws_ship_date_sk_ndv", compute_stats(ws_ship_date_sk, 20).numdistinctvalues),map("ws_item_sk_ndv", compute_stats(ws_item_sk, 20).numdistinctvalues),map("ws_bill_customer_sk_ndv", compute_stats(ws_bill_customer_sk, 20).numdistinctvalues),map("ws_bill_cdemo_sk_ndv", compute_stats(ws_bill_cdemo_sk, 20).numdistinctvalues),map("ws_bill_hdemo_sk_ndv", compute_stats(ws_bill_hdemo_sk, 20).numdistinctvalues),map("ws_bill_addr_sk_ndv", compute_stats(ws_bill_addr_sk, 20).numdistinctvalues),map("ws_ship_customer_sk_ndv", compute_stats(ws_ship_customer_sk, 20).numdistinctvalues),map("ws_ship_cdemo_sk_ndv", compute_stats(ws_ship_cdemo_sk, 20).numdistinctvalues),map("ws_ship_hdemo_sk_ndv", compute_stats(ws_ship_hdemo_sk, 20).numdistinctvalues),map("ws_ship_addr_sk_ndv", compute_stats(ws_ship_addr_sk, 20).numdistinctvalues),map("ws_web_page_sk_ndv", compute_stats(ws_web_page_sk, 20).numdistinctvalues),map("ws_web_site_sk_ndv", compute_stats(ws_web_site_sk, 20).numdistinctvalues),map("ws_ship_mode_sk_ndv", compute_stats(ws_ship_mode_sk, 20).numdistinctvalues),map("ws_warehouse_sk_ndv", compute_stats(ws_warehouse_sk, 20).numdistinctvalues),map("ws_promo_sk_ndv", compute_stats(ws_promo_sk, 20).numdistinctvalues),map("ws_order_number_ndv", compute_stats(ws_order_number, 20).numdistinctvalues),map("ws_quantity_ndv", compute_stats(ws_quantity, 20).numdistinctvalues),map("ws_wholesale_cost_ndv", compute_stats(ws_wholesale_cost, 20).numdistinctvalues),map("ws_list_price_ndv", compute_stats(ws_list_price, 20).numdistinctvalues),map("ws_sales_price_ndv", compute_stats(ws_sales_price, 20).numdistinctvalues),map("ws_ext_discount_amt_ndv", compute_stats(ws_ext_discount_amt, 20).numdistinctvalues),map("ws_ext_sales_price_ndv", compute_stats(ws_ext_sales_price, 20).numdistinctvalues),map("ws_ext_wholesale_cost_ndv", compute_stats(ws_ext_wholesale_cost, 20).numdistinctvalues),map("ws_ext_list_price_ndv", compute_stats(ws_ext_list_price, 20).numdistinctvalues),map("ws_ext_tax_ndv", compute_stats(ws_ext_tax, 20).numdistinctvalues),map("ws_coupon_amt_ndv", compute_stats(ws_coupon_amt, 20).numdistinctvalues),map("ws_ext_ship_cost_ndv", compute_stats(ws_ext_ship_cost, 20).numdistinctvalues),map("ws_net_paid_ndv", compute_stats(ws_net_paid, 20).numdistinctvalues),map("ws_net_paid_inc_tax_ndv", compute_stats(ws_net_paid_inc_tax, 20).numdistinctvalues),map("ws_net_paid_inc_ship_ndv", compute_stats(ws_net_paid_inc_ship, 20).numdistinctvalues),map("ws_net_paid_inc_ship_tax_ndv", compute_stats(ws_net_paid_inc_ship_tax, 20).numdistinctvalues),map("ws_net_profit_ndv", compute_stats(ws_net_profit, 20).numdistinctvalues),map("ws_sold_date_sk_ndv", compute_stats(ws_sold_date_sk, 20).numdistinctvalues),map("ws_sold_date_sk_ndv", compute_stats(ws_sold_date_sk, 20).numdistinctvalues) from web_sales where ws_sold_date_sk is not null' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/web_sales_1.txt
$hive -e 'select map("cr_returned_time_sk_ndv", compute_stats(cr_returned_time_sk, 20).numdistinctvalues),map("cr_item_sk_ndv", compute_stats(cr_item_sk, 20).numdistinctvalues),map("cr_refunded_customer_sk_ndv", compute_stats(cr_refunded_customer_sk, 20).numdistinctvalues),map("cr_refunded_cdemo_sk_ndv", compute_stats(cr_refunded_cdemo_sk, 20).numdistinctvalues),map("cr_refunded_hdemo_sk_ndv", compute_stats(cr_refunded_hdemo_sk, 20).numdistinctvalues),map("cr_refunded_addr_sk_ndv", compute_stats(cr_refunded_addr_sk, 20).numdistinctvalues),map("cr_returning_customer_sk_ndv", compute_stats(cr_returning_customer_sk, 20).numdistinctvalues),map("cr_returning_cdemo_sk_ndv", compute_stats(cr_returning_cdemo_sk, 20).numdistinctvalues),map("cr_returning_hdemo_sk_ndv", compute_stats(cr_returning_hdemo_sk, 20).numdistinctvalues),map("cr_returning_addr_sk_ndv", compute_stats(cr_returning_addr_sk, 20).numdistinctvalues),map("cr_call_center_sk_ndv", compute_stats(cr_call_center_sk, 20).numdistinctvalues),map("cr_catalog_page_sk_ndv", compute_stats(cr_catalog_page_sk, 20).numdistinctvalues),map("cr_ship_mode_sk_ndv", compute_stats(cr_ship_mode_sk, 20).numdistinctvalues),map("cr_warehouse_sk_ndv", compute_stats(cr_warehouse_sk, 20).numdistinctvalues),map("cr_reason_sk_ndv", compute_stats(cr_reason_sk, 20).numdistinctvalues),map("cr_order_number_ndv", compute_stats(cr_order_number, 20).numdistinctvalues),map("cr_return_quantity_ndv", compute_stats(cr_return_quantity, 20).numdistinctvalues),map("cr_return_amount_ndv", compute_stats(cr_return_amount, 20).numdistinctvalues),map("cr_return_tax_ndv", compute_stats(cr_return_tax, 20).numdistinctvalues),map("cr_return_amt_inc_tax_ndv", compute_stats(cr_return_amt_inc_tax, 20).numdistinctvalues),map("cr_fee_ndv", compute_stats(cr_fee, 20).numdistinctvalues),map("cr_return_ship_cost_ndv", compute_stats(cr_return_ship_cost, 20).numdistinctvalues),map("cr_refunded_cash_ndv", compute_stats(cr_refunded_cash, 20).numdistinctvalues),map("cr_reversed_charge_ndv", compute_stats(cr_reversed_charge, 20).numdistinctvalues),map("cr_store_credit_ndv", compute_stats(cr_store_credit, 20).numdistinctvalues),map("cr_net_loss_ndv", compute_stats(cr_net_loss, 20).numdistinctvalues),map("cr_returned_date_sk_ndv", compute_stats(cr_returned_date_sk, 20).numdistinctvalues),map("cr_returned_date_sk_ndv", compute_stats(cr_returned_date_sk, 20).numdistinctvalues) from catalog_returns' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/catalog_returns.txt
$hive -e 'select map("cr_returned_time_sk_ndv", compute_stats(cr_returned_time_sk, 20).numdistinctvalues),map("cr_item_sk_ndv", compute_stats(cr_item_sk, 20).numdistinctvalues),map("cr_refunded_customer_sk_ndv", compute_stats(cr_refunded_customer_sk, 20).numdistinctvalues),map("cr_refunded_cdemo_sk_ndv", compute_stats(cr_refunded_cdemo_sk, 20).numdistinctvalues),map("cr_refunded_hdemo_sk_ndv", compute_stats(cr_refunded_hdemo_sk, 20).numdistinctvalues),map("cr_refunded_addr_sk_ndv", compute_stats(cr_refunded_addr_sk, 20).numdistinctvalues),map("cr_returning_customer_sk_ndv", compute_stats(cr_returning_customer_sk, 20).numdistinctvalues),map("cr_returning_cdemo_sk_ndv", compute_stats(cr_returning_cdemo_sk, 20).numdistinctvalues),map("cr_returning_hdemo_sk_ndv", compute_stats(cr_returning_hdemo_sk, 20).numdistinctvalues),map("cr_returning_addr_sk_ndv", compute_stats(cr_returning_addr_sk, 20).numdistinctvalues),map("cr_call_center_sk_ndv", compute_stats(cr_call_center_sk, 20).numdistinctvalues),map("cr_catalog_page_sk_ndv", compute_stats(cr_catalog_page_sk, 20).numdistinctvalues),map("cr_ship_mode_sk_ndv", compute_stats(cr_ship_mode_sk, 20).numdistinctvalues),map("cr_warehouse_sk_ndv", compute_stats(cr_warehouse_sk, 20).numdistinctvalues),map("cr_reason_sk_ndv", compute_stats(cr_reason_sk, 20).numdistinctvalues),map("cr_order_number_ndv", compute_stats(cr_order_number, 20).numdistinctvalues),map("cr_return_quantity_ndv", compute_stats(cr_return_quantity, 20).numdistinctvalues),map("cr_return_amount_ndv", compute_stats(cr_return_amount, 20).numdistinctvalues),map("cr_return_tax_ndv", compute_stats(cr_return_tax, 20).numdistinctvalues),map("cr_return_amt_inc_tax_ndv", compute_stats(cr_return_amt_inc_tax, 20).numdistinctvalues),map("cr_fee_ndv", compute_stats(cr_fee, 20).numdistinctvalues),map("cr_return_ship_cost_ndv", compute_stats(cr_return_ship_cost, 20).numdistinctvalues),map("cr_refunded_cash_ndv", compute_stats(cr_refunded_cash, 20).numdistinctvalues),map("cr_reversed_charge_ndv", compute_stats(cr_reversed_charge, 20).numdistinctvalues),map("cr_store_credit_ndv", compute_stats(cr_store_credit, 20).numdistinctvalues),map("cr_net_loss_ndv", compute_stats(cr_net_loss, 20).numdistinctvalues),map("cr_returned_date_sk_ndv", compute_stats(cr_returned_date_sk, 20).numdistinctvalues),map("cr_returned_date_sk_ndv", compute_stats(cr_returned_date_sk, 20).numdistinctvalues) from catalog_returns where cr_returned_date_sk is not null' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/catalog_returns_1.txt
$hive -e 'select map("wr_returned_time_sk_ndv", compute_stats(wr_returned_time_sk, 20).numdistinctvalues),map("wr_item_sk_ndv", compute_stats(wr_item_sk, 20).numdistinctvalues),map("wr_refunded_customer_sk_ndv", compute_stats(wr_refunded_customer_sk, 20).numdistinctvalues),map("wr_refunded_cdemo_sk_ndv", compute_stats(wr_refunded_cdemo_sk, 20).numdistinctvalues),map("wr_refunded_hdemo_sk_ndv", compute_stats(wr_refunded_hdemo_sk, 20).numdistinctvalues),map("wr_refunded_addr_sk_ndv", compute_stats(wr_refunded_addr_sk, 20).numdistinctvalues),map("wr_returning_customer_sk_ndv", compute_stats(wr_returning_customer_sk, 20).numdistinctvalues),map("wr_returning_cdemo_sk_ndv", compute_stats(wr_returning_cdemo_sk, 20).numdistinctvalues),map("wr_returning_hdemo_sk_ndv", compute_stats(wr_returning_hdemo_sk, 20).numdistinctvalues),map("wr_returning_addr_sk_ndv", compute_stats(wr_returning_addr_sk, 20).numdistinctvalues),map("wr_web_page_sk_ndv", compute_stats(wr_web_page_sk, 20).numdistinctvalues),map("wr_reason_sk_ndv", compute_stats(wr_reason_sk, 20).numdistinctvalues),map("wr_order_number_ndv", compute_stats(wr_order_number, 20).numdistinctvalues),map("wr_return_quantity_ndv", compute_stats(wr_return_quantity, 20).numdistinctvalues),map("wr_return_amt_ndv", compute_stats(wr_return_amt, 20).numdistinctvalues),map("wr_return_tax_ndv", compute_stats(wr_return_tax, 20).numdistinctvalues),map("wr_return_amt_inc_tax_ndv", compute_stats(wr_return_amt_inc_tax, 20).numdistinctvalues),map("wr_fee_ndv", compute_stats(wr_fee, 20).numdistinctvalues),map("wr_return_ship_cost_ndv", compute_stats(wr_return_ship_cost, 20).numdistinctvalues),map("wr_refunded_cash_ndv", compute_stats(wr_refunded_cash, 20).numdistinctvalues),map("wr_reversed_charge_ndv", compute_stats(wr_reversed_charge, 20).numdistinctvalues),map("wr_account_credit_ndv", compute_stats(wr_account_credit, 20).numdistinctvalues),map("wr_net_loss_ndv", compute_stats(wr_net_loss, 20).numdistinctvalues),map("wr_returned_date_sk_ndv", compute_stats(wr_returned_date_sk, 20).numdistinctvalues),map("wr_returned_date_sk_ndv", compute_stats(wr_returned_date_sk, 20).numdistinctvalues) from web_returns' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/web_returns.txt
$hive -e 'select map("wr_returned_time_sk_ndv", compute_stats(wr_returned_time_sk, 20).numdistinctvalues),map("wr_item_sk_ndv", compute_stats(wr_item_sk, 20).numdistinctvalues),map("wr_refunded_customer_sk_ndv", compute_stats(wr_refunded_customer_sk, 20).numdistinctvalues),map("wr_refunded_cdemo_sk_ndv", compute_stats(wr_refunded_cdemo_sk, 20).numdistinctvalues),map("wr_refunded_hdemo_sk_ndv", compute_stats(wr_refunded_hdemo_sk, 20).numdistinctvalues),map("wr_refunded_addr_sk_ndv", compute_stats(wr_refunded_addr_sk, 20).numdistinctvalues),map("wr_returning_customer_sk_ndv", compute_stats(wr_returning_customer_sk, 20).numdistinctvalues),map("wr_returning_cdemo_sk_ndv", compute_stats(wr_returning_cdemo_sk, 20).numdistinctvalues),map("wr_returning_hdemo_sk_ndv", compute_stats(wr_returning_hdemo_sk, 20).numdistinctvalues),map("wr_returning_addr_sk_ndv", compute_stats(wr_returning_addr_sk, 20).numdistinctvalues),map("wr_web_page_sk_ndv", compute_stats(wr_web_page_sk, 20).numdistinctvalues),map("wr_reason_sk_ndv", compute_stats(wr_reason_sk, 20).numdistinctvalues),map("wr_order_number_ndv", compute_stats(wr_order_number, 20).numdistinctvalues),map("wr_return_quantity_ndv", compute_stats(wr_return_quantity, 20).numdistinctvalues),map("wr_return_amt_ndv", compute_stats(wr_return_amt, 20).numdistinctvalues),map("wr_return_tax_ndv", compute_stats(wr_return_tax, 20).numdistinctvalues),map("wr_return_amt_inc_tax_ndv", compute_stats(wr_return_amt_inc_tax, 20).numdistinctvalues),map("wr_fee_ndv", compute_stats(wr_fee, 20).numdistinctvalues),map("wr_return_ship_cost_ndv", compute_stats(wr_return_ship_cost, 20).numdistinctvalues),map("wr_refunded_cash_ndv", compute_stats(wr_refunded_cash, 20).numdistinctvalues),map("wr_reversed_charge_ndv", compute_stats(wr_reversed_charge, 20).numdistinctvalues),map("wr_account_credit_ndv", compute_stats(wr_account_credit, 20).numdistinctvalues),map("wr_net_loss_ndv", compute_stats(wr_net_loss, 20).numdistinctvalues),map("wr_returned_date_sk_ndv", compute_stats(wr_returned_date_sk, 20).numdistinctvalues),map("wr_returned_date_sk_ndv", compute_stats(wr_returned_date_sk, 20).numdistinctvalues) from web_returns where wr_returned_date_sk is not null' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/web_returns_1.txt
$hive -e 'select map("cd_demo_sk_ndv", compute_stats(cd_demo_sk, 20).numdistinctvalues),map("cd_gender_ndv", compute_stats(cd_gender, 20).numdistinctvalues),map("cd_marital_status_ndv", compute_stats(cd_marital_status, 20).numdistinctvalues),map("cd_education_status_ndv", compute_stats(cd_education_status, 20).numdistinctvalues),map("cd_purchase_estimate_ndv", compute_stats(cd_purchase_estimate, 20).numdistinctvalues),map("cd_credit_rating_ndv", compute_stats(cd_credit_rating, 20).numdistinctvalues),map("cd_dep_count_ndv", compute_stats(cd_dep_count, 20).numdistinctvalues),map("cd_dep_employed_count_ndv", compute_stats(cd_dep_employed_count, 20).numdistinctvalues),map("cd_dep_college_count_ndv", compute_stats(cd_dep_college_count, 20).numdistinctvalues) from customer_demographics' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/customer_demographics.txt
$hive -e 'select map("web_site_sk_ndv", compute_stats(web_site_sk, 20).numdistinctvalues),map("web_site_id_ndv", compute_stats(web_site_id, 20).numdistinctvalues),map("web_rec_start_date_ndv", compute_stats(web_rec_start_date, 20).numdistinctvalues),map("web_rec_end_date_ndv", compute_stats(web_rec_end_date, 20).numdistinctvalues),map("web_name_ndv", compute_stats(web_name, 20).numdistinctvalues),map("web_open_date_sk_ndv", compute_stats(web_open_date_sk, 20).numdistinctvalues),map("web_close_date_sk_ndv", compute_stats(web_close_date_sk, 20).numdistinctvalues),map("web_class_ndv", compute_stats(web_class, 20).numdistinctvalues),map("web_manager_ndv", compute_stats(web_manager, 20).numdistinctvalues),map("web_mkt_id_ndv", compute_stats(web_mkt_id, 20).numdistinctvalues),map("web_mkt_class_ndv", compute_stats(web_mkt_class, 20).numdistinctvalues),map("web_mkt_desc_ndv", compute_stats(web_mkt_desc, 20).numdistinctvalues),map("web_market_manager_ndv", compute_stats(web_market_manager, 20).numdistinctvalues),map("web_company_id_ndv", compute_stats(web_company_id, 20).numdistinctvalues),map("web_company_name_ndv", compute_stats(web_company_name, 20).numdistinctvalues),map("web_street_number_ndv", compute_stats(web_street_number, 20).numdistinctvalues),map("web_street_name_ndv", compute_stats(web_street_name, 20).numdistinctvalues),map("web_street_type_ndv", compute_stats(web_street_type, 20).numdistinctvalues),map("web_suite_number_ndv", compute_stats(web_suite_number, 20).numdistinctvalues),map("web_city_ndv", compute_stats(web_city, 20).numdistinctvalues),map("web_county_ndv", compute_stats(web_county, 20).numdistinctvalues),map("web_state_ndv", compute_stats(web_state, 20).numdistinctvalues),map("web_zip_ndv", compute_stats(web_zip, 20).numdistinctvalues),map("web_country_ndv", compute_stats(web_country, 20).numdistinctvalues),map("web_gmt_offset_ndv", compute_stats(web_gmt_offset, 20).numdistinctvalues),map("web_tax_percentage_ndv", compute_stats(web_tax_percentage, 20).numdistinctvalues) from web_site' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/web_site.txt
$hive -e 'select map("hd_demo_sk_ndv", compute_stats(hd_demo_sk, 20).numdistinctvalues),map("hd_income_band_sk_ndv", compute_stats(hd_income_band_sk, 20).numdistinctvalues),map("hd_buy_potential_ndv", compute_stats(hd_buy_potential, 20).numdistinctvalues),map("hd_dep_count_ndv", compute_stats(hd_dep_count, 20).numdistinctvalues),map("hd_vehicle_count_ndv", compute_stats(hd_vehicle_count, 20).numdistinctvalues) from household_demographics' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/household_demographics.txt
$hive -e 'select map("inv_item_sk_ndv", compute_stats(inv_item_sk, 20).numdistinctvalues),map("inv_warehouse_sk_ndv", compute_stats(inv_warehouse_sk, 20).numdistinctvalues),map("inv_quantity_on_hand_ndv", compute_stats(inv_quantity_on_hand, 20).numdistinctvalues),map("inv_date_sk_ndv", compute_stats(inv_date_sk, 20).numdistinctvalues),map("inv_date_sk_ndv", compute_stats(inv_date_sk, 20).numdistinctvalues) from inventory' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/inventory.txt
$hive -e 'select map("inv_item_sk_ndv", compute_stats(inv_item_sk, 20).numdistinctvalues),map("inv_warehouse_sk_ndv", compute_stats(inv_warehouse_sk, 20).numdistinctvalues),map("inv_quantity_on_hand_ndv", compute_stats(inv_quantity_on_hand, 20).numdistinctvalues),map("inv_date_sk_ndv", compute_stats(inv_date_sk, 20).numdistinctvalues),map("inv_date_sk_ndv", compute_stats(inv_date_sk, 20).numdistinctvalues) from inventory where inv_date_sk is not null' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/inventory_1.txt
$hive -e 'select map("w_warehouse_sk_ndv", compute_stats(w_warehouse_sk, 20).numdistinctvalues),map("w_warehouse_id_ndv", compute_stats(w_warehouse_id, 20).numdistinctvalues),map("w_warehouse_name_ndv", compute_stats(w_warehouse_name, 20).numdistinctvalues),map("w_warehouse_sq_ft_ndv", compute_stats(w_warehouse_sq_ft, 20).numdistinctvalues),map("w_street_number_ndv", compute_stats(w_street_number, 20).numdistinctvalues),map("w_street_name_ndv", compute_stats(w_street_name, 20).numdistinctvalues),map("w_street_type_ndv", compute_stats(w_street_type, 20).numdistinctvalues),map("w_suite_number_ndv", compute_stats(w_suite_number, 20).numdistinctvalues),map("w_city_ndv", compute_stats(w_city, 20).numdistinctvalues),map("w_county_ndv", compute_stats(w_county, 20).numdistinctvalues),map("w_state_ndv", compute_stats(w_state, 20).numdistinctvalues),map("w_zip_ndv", compute_stats(w_zip, 20).numdistinctvalues),map("w_country_ndv", compute_stats(w_country, 20).numdistinctvalues),map("w_gmt_offset_ndv", compute_stats(w_gmt_offset, 20).numdistinctvalues) from warehouse' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/warehouse.txt
$hive -e 'select map("sr_return_time_sk_ndv", compute_stats(sr_return_time_sk, 20).numdistinctvalues),map("sr_item_sk_ndv", compute_stats(sr_item_sk, 20).numdistinctvalues),map("sr_customer_sk_ndv", compute_stats(sr_customer_sk, 20).numdistinctvalues),map("sr_cdemo_sk_ndv", compute_stats(sr_cdemo_sk, 20).numdistinctvalues),map("sr_hdemo_sk_ndv", compute_stats(sr_hdemo_sk, 20).numdistinctvalues),map("sr_addr_sk_ndv", compute_stats(sr_addr_sk, 20).numdistinctvalues),map("sr_store_sk_ndv", compute_stats(sr_store_sk, 20).numdistinctvalues),map("sr_reason_sk_ndv", compute_stats(sr_reason_sk, 20).numdistinctvalues),map("sr_ticket_number_ndv", compute_stats(sr_ticket_number, 20).numdistinctvalues),map("sr_return_quantity_ndv", compute_stats(sr_return_quantity, 20).numdistinctvalues),map("sr_return_amt_ndv", compute_stats(sr_return_amt, 20).numdistinctvalues),map("sr_return_tax_ndv", compute_stats(sr_return_tax, 20).numdistinctvalues),map("sr_return_amt_inc_tax_ndv", compute_stats(sr_return_amt_inc_tax, 20).numdistinctvalues),map("sr_fee_ndv", compute_stats(sr_fee, 20).numdistinctvalues),map("sr_return_ship_cost_ndv", compute_stats(sr_return_ship_cost, 20).numdistinctvalues),map("sr_refunded_cash_ndv", compute_stats(sr_refunded_cash, 20).numdistinctvalues),map("sr_reversed_charge_ndv", compute_stats(sr_reversed_charge, 20).numdistinctvalues),map("sr_store_credit_ndv", compute_stats(sr_store_credit, 20).numdistinctvalues),map("sr_net_loss_ndv", compute_stats(sr_net_loss, 20).numdistinctvalues),map("sr_returned_date_sk_ndv", compute_stats(sr_returned_date_sk, 20).numdistinctvalues),map("sr_returned_date_sk_ndv", compute_stats(sr_returned_date_sk, 20).numdistinctvalues) from store_returns' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/store_returns.txt
$hive -e 'select map("sr_return_time_sk_ndv", compute_stats(sr_return_time_sk, 20).numdistinctvalues),map("sr_item_sk_ndv", compute_stats(sr_item_sk, 20).numdistinctvalues),map("sr_customer_sk_ndv", compute_stats(sr_customer_sk, 20).numdistinctvalues),map("sr_cdemo_sk_ndv", compute_stats(sr_cdemo_sk, 20).numdistinctvalues),map("sr_hdemo_sk_ndv", compute_stats(sr_hdemo_sk, 20).numdistinctvalues),map("sr_addr_sk_ndv", compute_stats(sr_addr_sk, 20).numdistinctvalues),map("sr_store_sk_ndv", compute_stats(sr_store_sk, 20).numdistinctvalues),map("sr_reason_sk_ndv", compute_stats(sr_reason_sk, 20).numdistinctvalues),map("sr_ticket_number_ndv", compute_stats(sr_ticket_number, 20).numdistinctvalues),map("sr_return_quantity_ndv", compute_stats(sr_return_quantity, 20).numdistinctvalues),map("sr_return_amt_ndv", compute_stats(sr_return_amt, 20).numdistinctvalues),map("sr_return_tax_ndv", compute_stats(sr_return_tax, 20).numdistinctvalues),map("sr_return_amt_inc_tax_ndv", compute_stats(sr_return_amt_inc_tax, 20).numdistinctvalues),map("sr_fee_ndv", compute_stats(sr_fee, 20).numdistinctvalues),map("sr_return_ship_cost_ndv", compute_stats(sr_return_ship_cost, 20).numdistinctvalues),map("sr_refunded_cash_ndv", compute_stats(sr_refunded_cash, 20).numdistinctvalues),map("sr_reversed_charge_ndv", compute_stats(sr_reversed_charge, 20).numdistinctvalues),map("sr_store_credit_ndv", compute_stats(sr_store_credit, 20).numdistinctvalues),map("sr_net_loss_ndv", compute_stats(sr_net_loss, 20).numdistinctvalues),map("sr_returned_date_sk_ndv", compute_stats(sr_returned_date_sk, 20).numdistinctvalues),map("sr_returned_date_sk_ndv", compute_stats(sr_returned_date_sk, 20).numdistinctvalues) from store_returns where sr_returned_date_sk is not null' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/store_returns_1.txt
$hive -e 'select map("s_store_sk_ndv", compute_stats(s_store_sk, 20).numdistinctvalues),map("s_store_id_ndv", compute_stats(s_store_id, 20).numdistinctvalues),map("s_rec_start_date_ndv", compute_stats(s_rec_start_date, 20).numdistinctvalues),map("s_rec_end_date_ndv", compute_stats(s_rec_end_date, 20).numdistinctvalues),map("s_closed_date_sk_ndv", compute_stats(s_closed_date_sk, 20).numdistinctvalues),map("s_store_name_ndv", compute_stats(s_store_name, 20).numdistinctvalues),map("s_number_employees_ndv", compute_stats(s_number_employees, 20).numdistinctvalues),map("s_floor_space_ndv", compute_stats(s_floor_space, 20).numdistinctvalues),map("s_hours_ndv", compute_stats(s_hours, 20).numdistinctvalues),map("s_manager_ndv", compute_stats(s_manager, 20).numdistinctvalues),map("s_market_id_ndv", compute_stats(s_market_id, 20).numdistinctvalues),map("s_geography_class_ndv", compute_stats(s_geography_class, 20).numdistinctvalues),map("s_market_desc_ndv", compute_stats(s_market_desc, 20).numdistinctvalues),map("s_market_manager_ndv", compute_stats(s_market_manager, 20).numdistinctvalues),map("s_division_id_ndv", compute_stats(s_division_id, 20).numdistinctvalues),map("s_division_name_ndv", compute_stats(s_division_name, 20).numdistinctvalues),map("s_company_id_ndv", compute_stats(s_company_id, 20).numdistinctvalues),map("s_company_name_ndv", compute_stats(s_company_name, 20).numdistinctvalues),map("s_street_number_ndv", compute_stats(s_street_number, 20).numdistinctvalues),map("s_street_name_ndv", compute_stats(s_street_name, 20).numdistinctvalues),map("s_street_type_ndv", compute_stats(s_street_type, 20).numdistinctvalues),map("s_suite_number_ndv", compute_stats(s_suite_number, 20).numdistinctvalues),map("s_city_ndv", compute_stats(s_city, 20).numdistinctvalues),map("s_county_ndv", compute_stats(s_county, 20).numdistinctvalues),map("s_state_ndv", compute_stats(s_state, 20).numdistinctvalues),map("s_zip_ndv", compute_stats(s_zip, 20).numdistinctvalues),map("s_country_ndv", compute_stats(s_country, 20).numdistinctvalues),map("s_gmt_offset_ndv", compute_stats(s_gmt_offset, 20).numdistinctvalues),map("s_tax_precentage_ndv", compute_stats(s_tax_precentage, 20).numdistinctvalues) from store' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/store.txt
$hive -e 'select map("t_time_sk_ndv", compute_stats(t_time_sk, 20).numdistinctvalues),map("t_time_id_ndv", compute_stats(t_time_id, 20).numdistinctvalues),map("t_time_ndv", compute_stats(t_time, 20).numdistinctvalues),map("t_hour_ndv", compute_stats(t_hour, 20).numdistinctvalues),map("t_minute_ndv", compute_stats(t_minute, 20).numdistinctvalues),map("t_second_ndv", compute_stats(t_second, 20).numdistinctvalues),map("t_am_pm_ndv", compute_stats(t_am_pm, 20).numdistinctvalues),map("t_shift_ndv", compute_stats(t_shift, 20).numdistinctvalues),map("t_sub_shift_ndv", compute_stats(t_sub_shift, 20).numdistinctvalues),map("t_meal_time_ndv", compute_stats(t_meal_time, 20).numdistinctvalues) from time_dim' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/time_dim.txt
$hive -e 'select map("cc_call_center_sk_ndv", compute_stats(cc_call_center_sk, 20).numdistinctvalues),map("cc_call_center_id_ndv", compute_stats(cc_call_center_id, 20).numdistinctvalues),map("cc_rec_start_date_ndv", compute_stats(cc_rec_start_date, 20).numdistinctvalues),map("cc_rec_end_date_ndv", compute_stats(cc_rec_end_date, 20).numdistinctvalues),map("cc_closed_date_sk_ndv", compute_stats(cc_closed_date_sk, 20).numdistinctvalues),map("cc_open_date_sk_ndv", compute_stats(cc_open_date_sk, 20).numdistinctvalues),map("cc_name_ndv", compute_stats(cc_name, 20).numdistinctvalues),map("cc_class_ndv", compute_stats(cc_class, 20).numdistinctvalues),map("cc_employees_ndv", compute_stats(cc_employees, 20).numdistinctvalues),map("cc_sq_ft_ndv", compute_stats(cc_sq_ft, 20).numdistinctvalues),map("cc_hours_ndv", compute_stats(cc_hours, 20).numdistinctvalues),map("cc_manager_ndv", compute_stats(cc_manager, 20).numdistinctvalues),map("cc_mkt_id_ndv", compute_stats(cc_mkt_id, 20).numdistinctvalues),map("cc_mkt_class_ndv", compute_stats(cc_mkt_class, 20).numdistinctvalues),map("cc_mkt_desc_ndv", compute_stats(cc_mkt_desc, 20).numdistinctvalues),map("cc_market_manager_ndv", compute_stats(cc_market_manager, 20).numdistinctvalues),map("cc_division_ndv", compute_stats(cc_division, 20).numdistinctvalues),map("cc_division_name_ndv", compute_stats(cc_division_name, 20).numdistinctvalues),map("cc_company_ndv", compute_stats(cc_company, 20).numdistinctvalues),map("cc_company_name_ndv", compute_stats(cc_company_name, 20).numdistinctvalues),map("cc_street_number_ndv", compute_stats(cc_street_number, 20).numdistinctvalues),map("cc_street_name_ndv", compute_stats(cc_street_name, 20).numdistinctvalues),map("cc_street_type_ndv", compute_stats(cc_street_type, 20).numdistinctvalues),map("cc_suite_number_ndv", compute_stats(cc_suite_number, 20).numdistinctvalues),map("cc_city_ndv", compute_stats(cc_city, 20).numdistinctvalues),map("cc_county_ndv", compute_stats(cc_county, 20).numdistinctvalues),map("cc_state_ndv", compute_stats(cc_state, 20).numdistinctvalues),map("cc_zip_ndv", compute_stats(cc_zip, 20).numdistinctvalues),map("cc_country_ndv", compute_stats(cc_country, 20).numdistinctvalues),map("cc_gmt_offset_ndv", compute_stats(cc_gmt_offset, 20).numdistinctvalues),map("cc_tax_percentage_ndv", compute_stats(cc_tax_percentage, 20).numdistinctvalues) from call_center' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/call_center.txt
$hive -e 'select map("ca_address_sk_ndv", compute_stats(ca_address_sk, 20).numdistinctvalues),map("ca_address_id_ndv", compute_stats(ca_address_id, 20).numdistinctvalues),map("ca_street_number_ndv", compute_stats(ca_street_number, 20).numdistinctvalues),map("ca_street_name_ndv", compute_stats(ca_street_name, 20).numdistinctvalues),map("ca_street_type_ndv", compute_stats(ca_street_type, 20).numdistinctvalues),map("ca_suite_number_ndv", compute_stats(ca_suite_number, 20).numdistinctvalues),map("ca_city_ndv", compute_stats(ca_city, 20).numdistinctvalues),map("ca_county_ndv", compute_stats(ca_county, 20).numdistinctvalues),map("ca_state_ndv", compute_stats(ca_state, 20).numdistinctvalues),map("ca_zip_ndv", compute_stats(ca_zip, 20).numdistinctvalues),map("ca_country_ndv", compute_stats(ca_country, 20).numdistinctvalues),map("ca_gmt_offset_ndv", compute_stats(ca_gmt_offset, 20).numdistinctvalues),map("ca_location_type_ndv", compute_stats(ca_location_type, 20).numdistinctvalues) from customer_address' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/customer_address.txt
$hive -e 'select map("r_reason_sk_ndv", compute_stats(r_reason_sk, 20).numdistinctvalues),map("r_reason_id_ndv", compute_stats(r_reason_id, 20).numdistinctvalues),map("r_reason_desc_ndv", compute_stats(r_reason_desc, 20).numdistinctvalues) from reason' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/reason.txt
$hive -e 'select map("cp_catalog_page_sk_ndv", compute_stats(cp_catalog_page_sk, 20).numdistinctvalues),map("cp_catalog_page_id_ndv", compute_stats(cp_catalog_page_id, 20).numdistinctvalues),map("cp_start_date_sk_ndv", compute_stats(cp_start_date_sk, 20).numdistinctvalues),map("cp_end_date_sk_ndv", compute_stats(cp_end_date_sk, 20).numdistinctvalues),map("cp_department_ndv", compute_stats(cp_department, 20).numdistinctvalues),map("cp_catalog_number_ndv", compute_stats(cp_catalog_number, 20).numdistinctvalues),map("cp_catalog_page_number_ndv", compute_stats(cp_catalog_page_number, 20).numdistinctvalues),map("cp_description_ndv", compute_stats(cp_description, 20).numdistinctvalues),map("cp_type_ndv", compute_stats(cp_type, 20).numdistinctvalues) from catalog_page' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/catalog_page.txt
$hive -e 'select map("d_date_sk_ndv", compute_stats(d_date_sk, 20).numdistinctvalues),map("d_date_id_ndv", compute_stats(d_date_id, 20).numdistinctvalues),map("d_date_ndv", compute_stats(d_date, 20).numdistinctvalues),map("d_month_seq_ndv", compute_stats(d_month_seq, 20).numdistinctvalues),map("d_week_seq_ndv", compute_stats(d_week_seq, 20).numdistinctvalues),map("d_quarter_seq_ndv", compute_stats(d_quarter_seq, 20).numdistinctvalues),map("d_year_ndv", compute_stats(d_year, 20).numdistinctvalues),map("d_dow_ndv", compute_stats(d_dow, 20).numdistinctvalues),map("d_moy_ndv", compute_stats(d_moy, 20).numdistinctvalues),map("d_dom_ndv", compute_stats(d_dom, 20).numdistinctvalues),map("d_qoy_ndv", compute_stats(d_qoy, 20).numdistinctvalues),map("d_fy_year_ndv", compute_stats(d_fy_year, 20).numdistinctvalues),map("d_fy_quarter_seq_ndv", compute_stats(d_fy_quarter_seq, 20).numdistinctvalues),map("d_fy_week_seq_ndv", compute_stats(d_fy_week_seq, 20).numdistinctvalues),map("d_day_name_ndv", compute_stats(d_day_name, 20).numdistinctvalues),map("d_quarter_name_ndv", compute_stats(d_quarter_name, 20).numdistinctvalues),map("d_holiday_ndv", compute_stats(d_holiday, 20).numdistinctvalues),map("d_weekend_ndv", compute_stats(d_weekend, 20).numdistinctvalues),map("d_following_holiday_ndv", compute_stats(d_following_holiday, 20).numdistinctvalues),map("d_first_dom_ndv", compute_stats(d_first_dom, 20).numdistinctvalues),map("d_last_dom_ndv", compute_stats(d_last_dom, 20).numdistinctvalues),map("d_same_day_ly_ndv", compute_stats(d_same_day_ly, 20).numdistinctvalues),map("d_same_day_lq_ndv", compute_stats(d_same_day_lq, 20).numdistinctvalues),map("d_current_day_ndv", compute_stats(d_current_day, 20).numdistinctvalues),map("d_current_week_ndv", compute_stats(d_current_week, 20).numdistinctvalues),map("d_current_month_ndv", compute_stats(d_current_month, 20).numdistinctvalues),map("d_current_quarter_ndv", compute_stats(d_current_quarter, 20).numdistinctvalues),map("d_current_year_ndv", compute_stats(d_current_year, 20).numdistinctvalues) from date_dim' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/date_dim.txt
$hive -e 'select map("c_customer_sk_ndv", compute_stats(c_customer_sk, 20).numdistinctvalues),map("c_customer_id_ndv", compute_stats(c_customer_id, 20).numdistinctvalues),map("c_current_cdemo_sk_ndv", compute_stats(c_current_cdemo_sk, 20).numdistinctvalues),map("c_current_hdemo_sk_ndv", compute_stats(c_current_hdemo_sk, 20).numdistinctvalues),map("c_current_addr_sk_ndv", compute_stats(c_current_addr_sk, 20).numdistinctvalues),map("c_first_shipto_date_sk_ndv", compute_stats(c_first_shipto_date_sk, 20).numdistinctvalues),map("c_first_sales_date_sk_ndv", compute_stats(c_first_sales_date_sk, 20).numdistinctvalues),map("c_salutation_ndv", compute_stats(c_salutation, 20).numdistinctvalues),map("c_first_name_ndv", compute_stats(c_first_name, 20).numdistinctvalues),map("c_last_name_ndv", compute_stats(c_last_name, 20).numdistinctvalues),map("c_preferred_cust_flag_ndv", compute_stats(c_preferred_cust_flag, 20).numdistinctvalues),map("c_birth_day_ndv", compute_stats(c_birth_day, 20).numdistinctvalues),map("c_birth_month_ndv", compute_stats(c_birth_month, 20).numdistinctvalues),map("c_birth_year_ndv", compute_stats(c_birth_year, 20).numdistinctvalues),map("c_birth_country_ndv", compute_stats(c_birth_country, 20).numdistinctvalues),map("c_login_ndv", compute_stats(c_login, 20).numdistinctvalues),map("c_email_address_ndv", compute_stats(c_email_address, 20).numdistinctvalues),map("c_last_review_date_ndv", compute_stats(c_last_review_date, 20).numdistinctvalues) from customer' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/customer.txt
$hive -e 'select map("ss_sold_time_sk_ndv", compute_stats(ss_sold_time_sk, 20).numdistinctvalues),map("ss_item_sk_ndv", compute_stats(ss_item_sk, 20).numdistinctvalues),map("ss_customer_sk_ndv", compute_stats(ss_customer_sk, 20).numdistinctvalues),map("ss_cdemo_sk_ndv", compute_stats(ss_cdemo_sk, 20).numdistinctvalues),map("ss_hdemo_sk_ndv", compute_stats(ss_hdemo_sk, 20).numdistinctvalues),map("ss_addr_sk_ndv", compute_stats(ss_addr_sk, 20).numdistinctvalues),map("ss_store_sk_ndv", compute_stats(ss_store_sk, 20).numdistinctvalues),map("ss_promo_sk_ndv", compute_stats(ss_promo_sk, 20).numdistinctvalues),map("ss_ticket_number_ndv", compute_stats(ss_ticket_number, 20).numdistinctvalues),map("ss_quantity_ndv", compute_stats(ss_quantity, 20).numdistinctvalues),map("ss_wholesale_cost_ndv", compute_stats(ss_wholesale_cost, 20).numdistinctvalues),map("ss_list_price_ndv", compute_stats(ss_list_price, 20).numdistinctvalues),map("ss_sales_price_ndv", compute_stats(ss_sales_price, 20).numdistinctvalues),map("ss_ext_discount_amt_ndv", compute_stats(ss_ext_discount_amt, 20).numdistinctvalues),map("ss_ext_sales_price_ndv", compute_stats(ss_ext_sales_price, 20).numdistinctvalues),map("ss_ext_wholesale_cost_ndv", compute_stats(ss_ext_wholesale_cost, 20).numdistinctvalues),map("ss_ext_list_price_ndv", compute_stats(ss_ext_list_price, 20).numdistinctvalues),map("ss_ext_tax_ndv", compute_stats(ss_ext_tax, 20).numdistinctvalues),map("ss_coupon_amt_ndv", compute_stats(ss_coupon_amt, 20).numdistinctvalues),map("ss_net_paid_ndv", compute_stats(ss_net_paid, 20).numdistinctvalues),map("ss_net_paid_inc_tax_ndv", compute_stats(ss_net_paid_inc_tax, 20).numdistinctvalues),map("ss_net_profit_ndv", compute_stats(ss_net_profit, 20).numdistinctvalues),map("ss_sold_date_sk_ndv", compute_stats(ss_sold_date_sk, 20).numdistinctvalues),map("ss_sold_date_sk_ndv", compute_stats(ss_sold_date_sk, 20).numdistinctvalues) from store_sales' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/store_sales.txt
$hive -e 'select map("ss_sold_time_sk_ndv", compute_stats(ss_sold_time_sk, 20).numdistinctvalues),map("ss_item_sk_ndv", compute_stats(ss_item_sk, 20).numdistinctvalues),map("ss_customer_sk_ndv", compute_stats(ss_customer_sk, 20).numdistinctvalues),map("ss_cdemo_sk_ndv", compute_stats(ss_cdemo_sk, 20).numdistinctvalues),map("ss_hdemo_sk_ndv", compute_stats(ss_hdemo_sk, 20).numdistinctvalues),map("ss_addr_sk_ndv", compute_stats(ss_addr_sk, 20).numdistinctvalues),map("ss_store_sk_ndv", compute_stats(ss_store_sk, 20).numdistinctvalues),map("ss_promo_sk_ndv", compute_stats(ss_promo_sk, 20).numdistinctvalues),map("ss_ticket_number_ndv", compute_stats(ss_ticket_number, 20).numdistinctvalues),map("ss_quantity_ndv", compute_stats(ss_quantity, 20).numdistinctvalues),map("ss_wholesale_cost_ndv", compute_stats(ss_wholesale_cost, 20).numdistinctvalues),map("ss_list_price_ndv", compute_stats(ss_list_price, 20).numdistinctvalues),map("ss_sales_price_ndv", compute_stats(ss_sales_price, 20).numdistinctvalues),map("ss_ext_discount_amt_ndv", compute_stats(ss_ext_discount_amt, 20).numdistinctvalues),map("ss_ext_sales_price_ndv", compute_stats(ss_ext_sales_price, 20).numdistinctvalues),map("ss_ext_wholesale_cost_ndv", compute_stats(ss_ext_wholesale_cost, 20).numdistinctvalues),map("ss_ext_list_price_ndv", compute_stats(ss_ext_list_price, 20).numdistinctvalues),map("ss_ext_tax_ndv", compute_stats(ss_ext_tax, 20).numdistinctvalues),map("ss_coupon_amt_ndv", compute_stats(ss_coupon_amt, 20).numdistinctvalues),map("ss_net_paid_ndv", compute_stats(ss_net_paid, 20).numdistinctvalues),map("ss_net_paid_inc_tax_ndv", compute_stats(ss_net_paid_inc_tax, 20).numdistinctvalues),map("ss_net_profit_ndv", compute_stats(ss_net_profit, 20).numdistinctvalues),map("ss_sold_date_sk_ndv", compute_stats(ss_sold_date_sk, 20).numdistinctvalues),map("ss_sold_date_sk_ndv", compute_stats(ss_sold_date_sk, 20).numdistinctvalues) from store_sales where ss_sold_date_sk is not null' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/store_sales_1.txt
$hive -e 'select map("cs_sold_time_sk_ndv", compute_stats(cs_sold_time_sk, 20).numdistinctvalues),map("cs_ship_date_sk_ndv", compute_stats(cs_ship_date_sk, 20).numdistinctvalues),map("cs_bill_customer_sk_ndv", compute_stats(cs_bill_customer_sk, 20).numdistinctvalues),map("cs_bill_cdemo_sk_ndv", compute_stats(cs_bill_cdemo_sk, 20).numdistinctvalues),map("cs_bill_hdemo_sk_ndv", compute_stats(cs_bill_hdemo_sk, 20).numdistinctvalues),map("cs_bill_addr_sk_ndv", compute_stats(cs_bill_addr_sk, 20).numdistinctvalues),map("cs_ship_customer_sk_ndv", compute_stats(cs_ship_customer_sk, 20).numdistinctvalues),map("cs_ship_cdemo_sk_ndv", compute_stats(cs_ship_cdemo_sk, 20).numdistinctvalues),map("cs_ship_hdemo_sk_ndv", compute_stats(cs_ship_hdemo_sk, 20).numdistinctvalues),map("cs_ship_addr_sk_ndv", compute_stats(cs_ship_addr_sk, 20).numdistinctvalues),map("cs_call_center_sk_ndv", compute_stats(cs_call_center_sk, 20).numdistinctvalues),map("cs_catalog_page_sk_ndv", compute_stats(cs_catalog_page_sk, 20).numdistinctvalues),map("cs_ship_mode_sk_ndv", compute_stats(cs_ship_mode_sk, 20).numdistinctvalues),map("cs_warehouse_sk_ndv", compute_stats(cs_warehouse_sk, 20).numdistinctvalues),map("cs_item_sk_ndv", compute_stats(cs_item_sk, 20).numdistinctvalues),map("cs_promo_sk_ndv", compute_stats(cs_promo_sk, 20).numdistinctvalues),map("cs_order_number_ndv", compute_stats(cs_order_number, 20).numdistinctvalues),map("cs_quantity_ndv", compute_stats(cs_quantity, 20).numdistinctvalues),map("cs_wholesale_cost_ndv", compute_stats(cs_wholesale_cost, 20).numdistinctvalues),map("cs_list_price_ndv", compute_stats(cs_list_price, 20).numdistinctvalues),map("cs_sales_price_ndv", compute_stats(cs_sales_price, 20).numdistinctvalues),map("cs_ext_discount_amt_ndv", compute_stats(cs_ext_discount_amt, 20).numdistinctvalues),map("cs_ext_sales_price_ndv", compute_stats(cs_ext_sales_price, 20).numdistinctvalues),map("cs_ext_wholesale_cost_ndv", compute_stats(cs_ext_wholesale_cost, 20).numdistinctvalues),map("cs_ext_list_price_ndv", compute_stats(cs_ext_list_price, 20).numdistinctvalues),map("cs_ext_tax_ndv", compute_stats(cs_ext_tax, 20).numdistinctvalues),map("cs_coupon_amt_ndv", compute_stats(cs_coupon_amt, 20).numdistinctvalues),map("cs_ext_ship_cost_ndv", compute_stats(cs_ext_ship_cost, 20).numdistinctvalues),map("cs_net_paid_ndv", compute_stats(cs_net_paid, 20).numdistinctvalues),map("cs_net_paid_inc_tax_ndv", compute_stats(cs_net_paid_inc_tax, 20).numdistinctvalues),map("cs_net_paid_inc_ship_ndv", compute_stats(cs_net_paid_inc_ship, 20).numdistinctvalues),map("cs_net_paid_inc_ship_tax_ndv", compute_stats(cs_net_paid_inc_ship_tax, 20).numdistinctvalues),map("cs_net_profit_ndv", compute_stats(cs_net_profit, 20).numdistinctvalues),map("cs_sold_date_sk_ndv", compute_stats(cs_sold_date_sk, 20).numdistinctvalues),map("cs_sold_date_sk_ndv", compute_stats(cs_sold_date_sk, 20).numdistinctvalues) from catalog_sales' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/catalog_sales.txt
$hive -e 'select map("cs_sold_time_sk_ndv", compute_stats(cs_sold_time_sk, 20).numdistinctvalues),map("cs_ship_date_sk_ndv", compute_stats(cs_ship_date_sk, 20).numdistinctvalues),map("cs_bill_customer_sk_ndv", compute_stats(cs_bill_customer_sk, 20).numdistinctvalues),map("cs_bill_cdemo_sk_ndv", compute_stats(cs_bill_cdemo_sk, 20).numdistinctvalues),map("cs_bill_hdemo_sk_ndv", compute_stats(cs_bill_hdemo_sk, 20).numdistinctvalues),map("cs_bill_addr_sk_ndv", compute_stats(cs_bill_addr_sk, 20).numdistinctvalues),map("cs_ship_customer_sk_ndv", compute_stats(cs_ship_customer_sk, 20).numdistinctvalues),map("cs_ship_cdemo_sk_ndv", compute_stats(cs_ship_cdemo_sk, 20).numdistinctvalues),map("cs_ship_hdemo_sk_ndv", compute_stats(cs_ship_hdemo_sk, 20).numdistinctvalues),map("cs_ship_addr_sk_ndv", compute_stats(cs_ship_addr_sk, 20).numdistinctvalues),map("cs_call_center_sk_ndv", compute_stats(cs_call_center_sk, 20).numdistinctvalues),map("cs_catalog_page_sk_ndv", compute_stats(cs_catalog_page_sk, 20).numdistinctvalues),map("cs_ship_mode_sk_ndv", compute_stats(cs_ship_mode_sk, 20).numdistinctvalues),map("cs_warehouse_sk_ndv", compute_stats(cs_warehouse_sk, 20).numdistinctvalues),map("cs_item_sk_ndv", compute_stats(cs_item_sk, 20).numdistinctvalues),map("cs_promo_sk_ndv", compute_stats(cs_promo_sk, 20).numdistinctvalues),map("cs_order_number_ndv", compute_stats(cs_order_number, 20).numdistinctvalues),map("cs_quantity_ndv", compute_stats(cs_quantity, 20).numdistinctvalues),map("cs_wholesale_cost_ndv", compute_stats(cs_wholesale_cost, 20).numdistinctvalues),map("cs_list_price_ndv", compute_stats(cs_list_price, 20).numdistinctvalues),map("cs_sales_price_ndv", compute_stats(cs_sales_price, 20).numdistinctvalues),map("cs_ext_discount_amt_ndv", compute_stats(cs_ext_discount_amt, 20).numdistinctvalues),map("cs_ext_sales_price_ndv", compute_stats(cs_ext_sales_price, 20).numdistinctvalues),map("cs_ext_wholesale_cost_ndv", compute_stats(cs_ext_wholesale_cost, 20).numdistinctvalues),map("cs_ext_list_price_ndv", compute_stats(cs_ext_list_price, 20).numdistinctvalues),map("cs_ext_tax_ndv", compute_stats(cs_ext_tax, 20).numdistinctvalues),map("cs_coupon_amt_ndv", compute_stats(cs_coupon_amt, 20).numdistinctvalues),map("cs_ext_ship_cost_ndv", compute_stats(cs_ext_ship_cost, 20).numdistinctvalues),map("cs_net_paid_ndv", compute_stats(cs_net_paid, 20).numdistinctvalues),map("cs_net_paid_inc_tax_ndv", compute_stats(cs_net_paid_inc_tax, 20).numdistinctvalues),map("cs_net_paid_inc_ship_ndv", compute_stats(cs_net_paid_inc_ship, 20).numdistinctvalues),map("cs_net_paid_inc_ship_tax_ndv", compute_stats(cs_net_paid_inc_ship_tax, 20).numdistinctvalues),map("cs_net_profit_ndv", compute_stats(cs_net_profit, 20).numdistinctvalues),map("cs_sold_date_sk_ndv", compute_stats(cs_sold_date_sk, 20).numdistinctvalues),map("cs_sold_date_sk_ndv", compute_stats(cs_sold_date_sk, 20).numdistinctvalues) from catalog_sales where cs_sold_date_sk is not null' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/catalog_sales_1.txt
$hive -e 'select map("i_item_sk_ndv", compute_stats(i_item_sk, 20).numdistinctvalues),map("i_item_id_ndv", compute_stats(i_item_id, 20).numdistinctvalues),map("i_rec_start_date_ndv", compute_stats(i_rec_start_date, 20).numdistinctvalues),map("i_rec_end_date_ndv", compute_stats(i_rec_end_date, 20).numdistinctvalues),map("i_item_desc_ndv", compute_stats(i_item_desc, 20).numdistinctvalues),map("i_current_price_ndv", compute_stats(i_current_price, 20).numdistinctvalues),map("i_wholesale_cost_ndv", compute_stats(i_wholesale_cost, 20).numdistinctvalues),map("i_brand_id_ndv", compute_stats(i_brand_id, 20).numdistinctvalues),map("i_brand_ndv", compute_stats(i_brand, 20).numdistinctvalues),map("i_class_id_ndv", compute_stats(i_class_id, 20).numdistinctvalues),map("i_class_ndv", compute_stats(i_class, 20).numdistinctvalues),map("i_category_id_ndv", compute_stats(i_category_id, 20).numdistinctvalues),map("i_category_ndv", compute_stats(i_category, 20).numdistinctvalues),map("i_manufact_id_ndv", compute_stats(i_manufact_id, 20).numdistinctvalues),map("i_manufact_ndv", compute_stats(i_manufact, 20).numdistinctvalues),map("i_size_ndv", compute_stats(i_size, 20).numdistinctvalues),map("i_formulation_ndv", compute_stats(i_formulation, 20).numdistinctvalues),map("i_color_ndv", compute_stats(i_color, 20).numdistinctvalues),map("i_units_ndv", compute_stats(i_units, 20).numdistinctvalues),map("i_container_ndv", compute_stats(i_container, 20).numdistinctvalues),map("i_manager_id_ndv", compute_stats(i_manager_id, 20).numdistinctvalues),map("i_product_name_ndv", compute_stats(i_product_name, 20).numdistinctvalues) from item' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/item.txt
$hive -e 'select map("p_promo_sk_ndv", compute_stats(p_promo_sk, 20).numdistinctvalues),map("p_promo_id_ndv", compute_stats(p_promo_id, 20).numdistinctvalues),map("p_start_date_sk_ndv", compute_stats(p_start_date_sk, 20).numdistinctvalues),map("p_end_date_sk_ndv", compute_stats(p_end_date_sk, 20).numdistinctvalues),map("p_item_sk_ndv", compute_stats(p_item_sk, 20).numdistinctvalues),map("p_cost_ndv", compute_stats(p_cost, 20).numdistinctvalues),map("p_response_target_ndv", compute_stats(p_response_target, 20).numdistinctvalues),map("p_promo_name_ndv", compute_stats(p_promo_name, 20).numdistinctvalues),map("p_channel_dmail_ndv", compute_stats(p_channel_dmail, 20).numdistinctvalues),map("p_channel_email_ndv", compute_stats(p_channel_email, 20).numdistinctvalues),map("p_channel_catalog_ndv", compute_stats(p_channel_catalog, 20).numdistinctvalues),map("p_channel_tv_ndv", compute_stats(p_channel_tv, 20).numdistinctvalues),map("p_channel_radio_ndv", compute_stats(p_channel_radio, 20).numdistinctvalues),map("p_channel_press_ndv", compute_stats(p_channel_press, 20).numdistinctvalues),map("p_channel_event_ndv", compute_stats(p_channel_event, 20).numdistinctvalues),map("p_channel_demo_ndv", compute_stats(p_channel_demo, 20).numdistinctvalues),map("p_channel_details_ndv", compute_stats(p_channel_details, 20).numdistinctvalues),map("p_purpose_ndv", compute_stats(p_purpose, 20).numdistinctvalues),map("p_discount_active_ndv", compute_stats(p_discount_active, 20).numdistinctvalues) from promotion' --database tpcds_bin_partitioned_orc_10000 > /tmp/tmpK8wOdm/promotion.txt

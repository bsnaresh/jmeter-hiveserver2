{"STAGE DEPENDENCIES":{"Stage-1":{"ROOT STAGE":"TRUE"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-1":{"Tez":{"DagId:":"hive_20170626030857_3d50a634-f254-4233-b2e7-320380e337cf:510","Edges:":{"Map 3":[{"parent":"Map 1","type":"BROADCAST_EDGE"},{"parent":"Map 2","type":"BROADCAST_EDGE"},{"parent":"Map 5","type":"BROADCAST_EDGE"},{"parent":"Map 6","type":"BROADCAST_EDGE"}],"Reducer 4":{"parent":"Map 3","type":"SIMPLE_EDGE"}},"DagName:":"query48.sql","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"date_dim","filterExpr:":"((d_year = 1998) and d_date_sk is not null) (type: boolean)","Statistics:":"Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"TS_0","children":{"Filter Operator":{"predicate:":"((d_year = 1998) and d_date_sk is not null) (type: boolean)","Statistics:":"Num rows: 652 Data size: 7824 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"FIL_104","children":{"Select Operator":{"expressions:":"d_date_sk (type: bigint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 652 Data size: 7824 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_105","children":[{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: bigint)","Statistics:":"Num rows: 652 Data size: 7824 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"RS_106","outputname:":"Map 3","outputOperator:":["TS_6"]}},{"Select Operator":{"expressions:":"_col0 (type: bigint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 652 Data size: 7824 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_107","children":{"Group By Operator":{"keys:":"_col0 (type: bigint)","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 326 Data size: 3912 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"GBY_108","children":{"Dynamic Partitioning Event Operator":{"Target column:":"ss_sold_date_sk (bigint)","Target Input:":"store_sales","Partition key expr:":"ss_sold_date_sk","Statistics:":"Num rows: 326 Data size: 3912 Basic stats: COMPLETE Column stats: COMPLETE","Target Vertex:":"Map 3","OperatorId:":"EVENT_109"}}}}}}]}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Map 2":{"Map Operator Tree:":[{"TableScan":{"alias:":"customer_demographics","filterExpr:":"((cd_marital_status = 'm') and (cd_education_status = '4 yr degree') and cd_demo_sk is not null) (type: boolean)","Statistics:":"Num rows: 883835 Data size: 165277145 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"TS_3","children":{"Filter Operator":{"predicate:":"((cd_marital_status = 'm') and (cd_education_status = '4 yr degree') and cd_demo_sk is not null) (type: boolean)","Statistics:":"Num rows: 63131 Data size: 11805497 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"FIL_101","children":{"Select Operator":{"expressions:":"cd_demo_sk (type: bigint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 63131 Data size: 11868628 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_102","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: bigint)","Statistics:":"Num rows: 63131 Data size: 11868628 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"RS_103","outputname:":"Map 3","outputOperator:":["TS_6"]}}}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Map 3":{"Map Operator Tree:":[{"TableScan":{"alias:":"store_sales","filterExpr:":"((ss_sales_price BETWEEN 100.0 AND 150.0 or ss_sales_price BETWEEN 50.0 AND 100.0 or ss_sales_price BETWEEN 150.0 AND 200.0) and (ss_net_profit BETWEEN 0.0 AND 2000.0 or ss_net_profit BETWEEN 150.0 AND 3000.0 or ss_net_profit BETWEEN 50.0 AND 25000.0) and ss_store_sk is not null and ss_cdemo_sk is not null and ss_addr_sk is not null) (type: boolean)","Statistics:":"Num rows: 275035746821 Data size: 14156226975140 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"TS_6","children":{"Filter Operator":{"predicate:":"((ss_sales_price BETWEEN 100.0 AND 150.0 or ss_sales_price BETWEEN 50.0 AND 100.0 or ss_sales_price BETWEEN 150.0 AND 200.0) and (ss_net_profit BETWEEN 0.0 AND 2000.0 or ss_net_profit BETWEEN 150.0 AND 3000.0 or ss_net_profit BETWEEN 50.0 AND 25000.0) and ss_store_sk is not null and ss_cdemo_sk is not null and ss_addr_sk is not null) (type: boolean)","Statistics:":"Num rows: 49115670121 Data size: 2528008021928 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"FIL_116","children":{"Select Operator":{"expressions:":"ss_cdemo_sk (type: bigint), ss_addr_sk (type: bigint), ss_store_sk (type: bigint), ss_quantity (type: int), ss_net_profit (type: double), ss_sold_date_sk (type: bigint)","outputColumnNames:":["_col0","_col1","_col2","_col3","_col5","_col6"],"Statistics:":"Num rows: 49115670121 Data size: 2528008021928 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_117","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col0 (type: bigint)","1":"_col0 (type: bigint)"},"outputColumnNames:":["_col4","_col5","_col6","_col8","_col9"],"input vertices:":{"0":"Map 2"},"Statistics:":"Num rows: 9457945938 Data size: 340486053768 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"MAPJOIN_118","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col4 (type: bigint)","1":"_col0 (type: bigint)"},"outputColumnNames:":["_col5","_col6","_col8","_col9","_col11"],"input vertices:":{"1":"Map 5"},"Statistics:":"Num rows: 5543044 Data size: 631907016 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"MAPJOIN_119","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col5 (type: bigint)","1":"_col0 (type: bigint)"},"outputColumnNames:":["_col6","_col8","_col9","_col11"],"input vertices:":{"1":"Map 6"},"Statistics:":"Num rows: 5543044 Data size: 587562664 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"MAPJOIN_120","children":{"Select Operator":{"expressions:":"_col6 (type: int), _col8 (type: double), _col9 (type: bigint), _col11 (type: string)","outputColumnNames:":["_col3","_col5","_col6","_col12"],"Statistics:":"Num rows: 5543044 Data size: 587562664 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_121","children":{"Filter Operator":{"predicate:":"(((_col12) IN ('ky', 'ga', 'nm') and _col5 BETWEEN 0.0 AND 2000.0) or ((_col12) IN ('mt', 'or', 'in') and _col5 BETWEEN 150.0 AND 3000.0) or ((_col12) IN ('wi', 'mo', 'wv') and _col5 BETWEEN 50.0 AND 25000.0)) (type: boolean)","Statistics:":"Num rows: 1026487 Data size: 108807622 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"FIL_122","children":{"Select Operator":{"expressions:":"_col3 (type: int), _col6 (type: bigint)","outputColumnNames:":["_col3","_col6"],"Statistics:":"Num rows: 1026487 Data size: 108807622 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_123","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col0 (type: bigint)","1":"_col6 (type: bigint)"},"outputColumnNames:":["_col5"],"input vertices:":{"0":"Map 1"},"Statistics:":"Num rows: 366518 Data size: 1466072 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"MAPJOIN_124","children":{"Group By Operator":{"aggregations:":["sum(_col5)"],"mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"GBY_125","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE","value expressions:":"_col0 (type: bigint)","OperatorId:":"RS_126","outputname:":"Reducer 4","outputOperator:":["GBY_127"]}}}}}}}}}}}}}}}}}}}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Map 5":{"Map Operator Tree:":[{"TableScan":{"alias:":"customer_address","filterExpr:":"((ca_state) IN ('ky', 'ga', 'nm', 'mt', 'or', 'in', 'wi', 'mo', 'wv') and (ca_country = 'united states') and ca_address_sk is not null) (type: boolean)","Statistics:":"Num rows: 500 Data size: 95500 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"TS_9","children":{"Filter Operator":{"predicate:":"((ca_state) IN ('ky', 'ga', 'nm', 'mt', 'or', 'in', 'wi', 'mo', 'wv') and (ca_country = 'united states') and ca_address_sk is not null) (type: boolean)","Statistics:":"Num rows: 88 Data size: 16808 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"FIL_110","children":{"Select Operator":{"expressions:":"ca_address_sk (type: bigint), ca_state (type: string)","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 88 Data size: 16808 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_111","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: bigint)","Statistics:":"Num rows: 88 Data size: 16808 Basic stats: COMPLETE Column stats: COMPLETE","value expressions:":"_col1 (type: string)","OperatorId:":"RS_112","outputname:":"Map 3","outputOperator:":["TS_6"]}}}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Map 6":{"Map Operator Tree:":[{"TableScan":{"alias:":"store","filterExpr:":"s_store_sk is not null (type: boolean)","Statistics:":"Num rows: 1902 Data size: 15216 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"TS_12","children":{"Filter Operator":{"predicate:":"s_store_sk is not null (type: boolean)","Statistics:":"Num rows: 1902 Data size: 15216 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"FIL_113","children":{"Select Operator":{"expressions:":"s_store_sk (type: bigint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1902 Data size: 15216 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_114","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: bigint)","Statistics:":"Num rows: 1902 Data size: 15216 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"RS_115","outputname:":"Map 3","outputOperator:":["TS_6"]}}}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Reducer 4":{"Execution mode:":"vectorized, llap","Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["sum(VALUE._col0)"],"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"GBY_127","children":{"File Output Operator":{"compressed:":"false","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_128"}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_129"}}}}}}
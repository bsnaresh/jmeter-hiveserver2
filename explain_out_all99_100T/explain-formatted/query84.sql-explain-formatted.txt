{"STAGE DEPENDENCIES":{"Stage-1":{"ROOT STAGE":"TRUE"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-1":{"Tez":{"DagId:":"hive_20170626031012_c34811f7-f82a-440d-a0a2-00f8c8a7194b:545","Edges:":{"Map 1":[{"parent":"Map 2","type":"BROADCAST_EDGE"},{"parent":"Map 3","type":"BROADCAST_EDGE"}],"Map 3":{"parent":"Map 4","type":"BROADCAST_EDGE"},"Map 5":{"parent":"Map 1","type":"BROADCAST_EDGE"},"Map 6":{"parent":"Map 5","type":"BROADCAST_EDGE"},"Reducer 7":{"parent":"Map 6","type":"SIMPLE_EDGE"}},"DagName:":"query84.sql","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"household_demographics","filterExpr:":"(hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)","Statistics:":"Num rows: 7200 Data size: 115200 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"TS_0","children":{"Filter Operator":{"predicate:":"(hd_demo_sk is not null and hd_income_band_sk is not null) (type: boolean)","Statistics:":"Num rows: 7200 Data size: 115200 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"FIL_135","children":{"Select Operator":{"expressions:":"hd_demo_sk (type: bigint), hd_income_band_sk (type: bigint)","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 7200 Data size: 115200 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_136","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col1 (type: bigint)","1":"_col0 (type: bigint)"},"outputColumnNames:":["_col0"],"input vertices:":{"1":"Map 2"},"Statistics:":"Num rows: 721 Data size: 5768 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"MAPJOIN_137","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col0 (type: bigint)","1":"_col2 (type: bigint)"},"outputColumnNames:":["_col5","_col6","_col9","_col10"],"input vertices:":{"1":"Map 3"},"Statistics:":"Num rows: 1 Data size: 288 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"MAPJOIN_138","children":{"Reduce Output Operator":{"key expressions:":"_col6 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col6 (type: bigint)","Statistics:":"Num rows: 1 Data size: 288 Basic stats: COMPLETE Column stats: COMPLETE","value expressions:":"_col5 (type: string), _col9 (type: string), _col10 (type: string)","OperatorId:":"RS_139","outputname:":"Map 5","outputOperator:":["TS_16"]}}}}}}}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Map 2":{"Map Operator Tree:":[{"TableScan":{"alias:":"income_band","filterExpr:":"((ib_lower_bound >= 32287) and (ib_upper_bound <= 82287) and ib_income_band_sk is not null) (type: boolean)","Statistics:":"Num rows: 20 Data size: 320 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"TS_3","children":{"Filter Operator":{"predicate:":"((ib_lower_bound >= 32287) and (ib_upper_bound <= 82287) and ib_income_band_sk is not null) (type: boolean)","Statistics:":"Num rows: 2 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"FIL_125","children":{"Select Operator":{"expressions:":"ib_income_band_sk (type: bigint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 2 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_126","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: bigint)","Statistics:":"Num rows: 2 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"RS_127","outputname:":"Map 1","outputOperator:":["TS_0"]}}}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Map 3":{"Map Operator Tree:":[{"TableScan":{"alias:":"customer","filterExpr:":"(c_current_addr_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null) (type: boolean)","Statistics:":"Num rows: 1000 Data size: 303584 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"TS_6","children":{"Filter Operator":{"predicate:":"(c_current_addr_sk is not null and c_current_cdemo_sk is not null and c_current_hdemo_sk is not null) (type: boolean)","Statistics:":"Num rows: 947 Data size: 287488 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"FIL_131","children":{"Select Operator":{"expressions:":"c_customer_id (type: string), c_current_cdemo_sk (type: bigint), c_current_hdemo_sk (type: bigint), c_current_addr_sk (type: bigint), c_first_name (type: string), c_last_name (type: string)","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4","_col5"],"Statistics:":"Num rows: 947 Data size: 287488 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_132","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col3 (type: bigint)","1":"_col0 (type: bigint)"},"outputColumnNames:":["_col0","_col1","_col2","_col4","_col5"],"input vertices:":{"1":"Map 4"},"Statistics:":"Num rows: 3 Data size: 888 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"MAPJOIN_133","children":{"Reduce Output Operator":{"key expressions:":"_col2 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col2 (type: bigint)","Statistics:":"Num rows: 3 Data size: 888 Basic stats: COMPLETE Column stats: COMPLETE","value expressions:":"_col0 (type: string), _col1 (type: bigint), _col4 (type: string), _col5 (type: string)","OperatorId:":"RS_134","outputname:":"Map 1","outputOperator:":["TS_0"]}}}}}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Map 4":{"Map Operator Tree:":[{"TableScan":{"alias:":"customer_address","filterExpr:":"((ca_city = 'hopewell') and ca_address_sk is not null) (type: boolean)","Statistics:":"Num rows: 500 Data size: 50500 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"TS_9","children":{"Filter Operator":{"predicate:":"((ca_city = 'hopewell') and ca_address_sk is not null) (type: boolean)","Statistics:":"Num rows: 4 Data size: 404 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"FIL_128","children":{"Select Operator":{"expressions:":"ca_address_sk (type: bigint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 4 Data size: 400 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_129","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: bigint)","Statistics:":"Num rows: 4 Data size: 400 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"RS_130","outputname:":"Map 3","outputOperator:":["TS_6"]}}}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Map 5":{"Map Operator Tree:":[{"TableScan":{"alias:":"customer_demographics","filterExpr:":"cd_demo_sk is not null (type: boolean)","Statistics:":"Num rows: 883835 Data size: 7070680 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"TS_16","children":{"Filter Operator":{"predicate:":"cd_demo_sk is not null (type: boolean)","Statistics:":"Num rows: 883835 Data size: 7070680 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"FIL_140","children":{"Select Operator":{"expressions:":"cd_demo_sk (type: bigint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 883835 Data size: 7070680 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_141","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col6 (type: bigint)","1":"_col0 (type: bigint)"},"outputColumnNames:":["_col5","_col9","_col10","_col13"],"input vertices:":{"0":"Map 1"},"Statistics:":"Num rows: 1 Data size: 288 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"MAPJOIN_142","children":{"Reduce Output Operator":{"key expressions:":"_col13 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col13 (type: bigint)","Statistics:":"Num rows: 1 Data size: 288 Basic stats: COMPLETE Column stats: COMPLETE","value expressions:":"_col5 (type: string), _col9 (type: string), _col10 (type: string)","OperatorId:":"RS_143","outputname:":"Map 6","outputOperator:":["TS_19"]}}}}}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Map 6":{"Map Operator Tree:":[{"TableScan":{"alias:":"store_returns","filterExpr:":"sr_cdemo_sk is not null (type: boolean)","Statistics:":"Num rows: 28777641316 Data size: 228382507984 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"TS_19","children":{"Filter Operator":{"predicate:":"sr_cdemo_sk is not null (type: boolean)","Statistics:":"Num rows: 28547813497 Data size: 226558569280 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"FIL_144","children":{"Select Operator":{"expressions:":"sr_cdemo_sk (type: bigint)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 28547813497 Data size: 226558569280 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_145","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col13 (type: bigint)","1":"_col0 (type: bigint)"},"outputColumnNames:":["_col5","_col9","_col10"],"input vertices:":{"0":"Map 5"},"Statistics:":"Num rows: 22168 Data size: 6207040 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"MAPJOIN_146","children":{"Select Operator":{"expressions:":"_col5 (type: string), concat(concat(_col10, ', '), _col9) (type: string)","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 22168 Data size: 6295712 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_147","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: string)","sort order:":"+","Statistics:":"Num rows: 22168 Data size: 6295712 Basic stats: COMPLETE Column stats: COMPLETE","TopN Hash Memory Usage:":"0.04","value expressions:":"_col1 (type: string)","OperatorId:":"RS_148","outputname:":"Reducer 7","outputOperator:":["SEL_149"]}}}}}}}}}}}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Reducer 7":{"Execution mode:":"vectorized, llap","Reduce Operator Tree:":{"Select Operator":{"expressions:":"KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 22168 Data size: 6295712 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_149","children":{"Limit":{"Number of rows:":"100","Statistics:":"Num rows: 100 Data size: 28400 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"LIM_150","children":{"File Output Operator":{"compressed:":"false","Statistics:":"Num rows: 100 Data size: 28400 Basic stats: COMPLETE Column stats: COMPLETE","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_151"}}}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"100","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_152"}}}}}}
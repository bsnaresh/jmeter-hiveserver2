{"STAGE DEPENDENCIES":{"Stage-1":{"ROOT STAGE":"TRUE"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}},"STAGE PLANS":{"Stage-1":{"Tez":{"DagId:":"hive_20170626030853_f02b6824-d361-4bbb-ae8a-b683e7788748:506","Edges:":{"Reducer 10":[{"parent":"Reducer 17","type":"XPROD_EDGE"},{"parent":"Reducer 9","type":"XPROD_EDGE"}],"Reducer 11":[{"parent":"Map 1","type":"BROADCAST_EDGE"},{"parent":"Reducer 10","type":"SIMPLE_EDGE"}],"Reducer 13":{"parent":"Map 12","type":"SIMPLE_EDGE"},"Reducer 14":{"parent":"Map 12","type":"SIMPLE_EDGE"},"Reducer 16":{"parent":"Map 15","type":"SIMPLE_EDGE"},"Reducer 17":{"parent":"Map 15","type":"SIMPLE_EDGE"},"Reducer 3":{"parent":"Map 2","type":"SIMPLE_EDGE"},"Reducer 4":[{"parent":"Reducer 13","type":"BROADCAST_EDGE"},{"parent":"Reducer 3","type":"SIMPLE_EDGE"}],"Reducer 5":[{"parent":"Reducer 16","type":"XPROD_EDGE"},{"parent":"Reducer 4","type":"XPROD_EDGE"}],"Reducer 6":[{"parent":"Map 1","type":"BROADCAST_EDGE"},{"parent":"Reducer 11","type":"BROADCAST_EDGE"},{"parent":"Reducer 5","type":"SIMPLE_EDGE"}],"Reducer 7":{"parent":"Reducer 6","type":"SIMPLE_EDGE"},"Reducer 8":{"parent":"Map 2","type":"SIMPLE_EDGE"},"Reducer 9":[{"parent":"Reducer 14","type":"BROADCAST_EDGE"},{"parent":"Reducer 8","type":"SIMPLE_EDGE"}]},"DagName:":"query44.sql","Vertices:":{"Map 1":{"Map Operator Tree:":[{"TableScan":{"alias:":"i1","filterExpr:":"(i_item_sk is not null or i_item_sk is not null) (type: boolean)","Statistics:":"Num rows: 502000 Data size: 57730000 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"TS_0","children":[{"Filter Operator":{"predicate:":"i_item_sk is not null (type: boolean)","Statistics:":"Num rows: 502000 Data size: 57730000 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"FIL_186","children":{"Select Operator":{"expressions:":"i_item_sk (type: bigint), i_product_name (type: string)","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 502000 Data size: 57730000 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_187","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: bigint)","Statistics:":"Num rows: 502000 Data size: 57730000 Basic stats: COMPLETE Column stats: COMPLETE","value expressions:":"_col1 (type: string)","OperatorId:":"RS_188","outputname:":"Reducer 6","outputOperator:":["SEL_41"]}}}}}},{"Filter Operator":{"predicate:":"i_item_sk is not null (type: boolean)","Statistics:":"Num rows: 502000 Data size: 57730000 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"FIL_189","children":{"Select Operator":{"expressions:":"i_item_sk (type: bigint), i_product_name (type: string)","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 502000 Data size: 57730000 Basic stats: COMPLETE Column stats: COMPLETE","OperatorId:":"SEL_190","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: bigint)","Statistics:":"Num rows: 502000 Data size: 57730000 Basic stats: COMPLETE Column stats: COMPLETE","value expressions:":"_col1 (type: string)","OperatorId:":"RS_191","outputname:":"Reducer 11","outputOperator:":["SEL_88"]}}}}}}]}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Map 12":{"Map Operator Tree:":[{"TableScan":{"alias:":"store_sales","filterExpr:":"((ss_store_sk = 410) and ss_hdemo_sk is null) (type: boolean)","Statistics:":"Num rows: 288018711538 Data size: 6832981396920 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"TS_18","children":[{"Filter Operator":{"predicate:":"((ss_store_sk = 410) and ss_hdemo_sk is null) (type: boolean)","Statistics:":"Num rows: 3863598 Data size: 91660368 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"FIL_169","children":{"Select Operator":{"expressions:":"ss_net_profit (type: double)","outputColumnNames:":["_col1"],"Statistics:":"Num rows: 3863598 Data size: 91660368 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_170","children":{"Group By Operator":{"aggregations:":["avg(_col1)"],"keys:":"410 (type: bigint)","mode:":"hash","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 26692 Data size: 2348896 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_171","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: bigint)","Statistics:":"Num rows: 26692 Data size: 2348896 Basic stats: COMPLETE Column stats: PARTIAL","value expressions:":"_col1 (type: struct<count:bigint,sum:double,input:double>)","OperatorId:":"RS_23","outputname:":"Reducer 13","outputOperator:":["GBY_24"]}}}}}}}},{"Filter Operator":{"predicate:":"((ss_store_sk = 410) and ss_hdemo_sk is null) (type: boolean)","Statistics:":"Num rows: 3863598 Data size: 91660368 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"FIL_172","children":{"Select Operator":{"expressions:":"ss_net_profit (type: double)","outputColumnNames:":["_col1"],"Statistics:":"Num rows: 3863598 Data size: 91660368 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_173","children":{"Group By Operator":{"aggregations:":["avg(_col1)"],"keys:":"410 (type: bigint)","mode:":"hash","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 26692 Data size: 2348896 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_174","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: bigint)","Statistics:":"Num rows: 26692 Data size: 2348896 Basic stats: COMPLETE Column stats: PARTIAL","value expressions:":"_col1 (type: struct<count:bigint,sum:double,input:double>)","OperatorId:":"RS_70","outputname:":"Reducer 14","outputOperator:":["GBY_71"]}}}}}}}}]}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Map 15":{"Map Operator Tree:":[{"TableScan":{"alias:":"ss1","filterExpr:":"(ss_store_sk = 410) (type: boolean)","Statistics:":"Num rows: 288018711538 Data size: 6859501134768 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"TS_26","children":[{"Filter Operator":{"predicate:":"(ss_store_sk = 410) (type: boolean)","Statistics:":"Num rows: 335686144 Data size: 7994756584 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"FIL_180","children":{"Select Operator":{"expressions:":"ss_item_sk (type: bigint), ss_net_profit (type: double)","outputColumnNames:":["ss_item_sk","ss_net_profit"],"Statistics:":"Num rows: 335686144 Data size: 7994756584 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_181","children":{"Group By Operator":{"aggregations:":["avg(ss_net_profit)"],"keys:":"ss_item_sk (type: bigint)","mode:":"hash","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 10155305 Data size: 893666840 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_182","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: bigint)","Statistics:":"Num rows: 10155305 Data size: 893666840 Basic stats: COMPLETE Column stats: PARTIAL","value expressions:":"_col1 (type: struct<count:bigint,sum:double,input:double>)","OperatorId:":"RS_30","outputname:":"Reducer 16","outputOperator:":["GBY_31"]}}}}}}}},{"Filter Operator":{"predicate:":"(ss_store_sk = 410) (type: boolean)","Statistics:":"Num rows: 335686144 Data size: 7994756584 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"FIL_183","children":{"Select Operator":{"expressions:":"ss_item_sk (type: bigint), ss_net_profit (type: double)","outputColumnNames:":["ss_item_sk","ss_net_profit"],"Statistics:":"Num rows: 335686144 Data size: 7994756584 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_184","children":{"Group By Operator":{"aggregations:":["avg(ss_net_profit)"],"keys:":"ss_item_sk (type: bigint)","mode:":"hash","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 10155305 Data size: 893666840 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_185","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: bigint)","Statistics:":"Num rows: 10155305 Data size: 893666840 Basic stats: COMPLETE Column stats: PARTIAL","value expressions:":"_col1 (type: struct<count:bigint,sum:double,input:double>)","OperatorId:":"RS_77","outputname:":"Reducer 17","outputOperator:":["GBY_78"]}}}}}}}}]}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Map 2":{"Map Operator Tree:":[{"TableScan":{"alias:":"store_sales","filterExpr:":"((ss_store_sk = 410) and ss_hdemo_sk is null) (type: boolean)","Statistics:":"Num rows: 288018711538 Data size: 4555337036384 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"TS_3","children":[{"Filter Operator":{"predicate:":"((ss_store_sk = 410) and ss_hdemo_sk is null) (type: boolean)","Statistics:":"Num rows: 3863598 Data size: 61107128 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"FIL_157","children":{"Select Operator":{"Statistics:":"Num rows: 3863598 Data size: 61107128 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_158","children":{"Group By Operator":{"keys:":"410 (type: bigint)","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 17795 Data size: 142360 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_159","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: bigint)","Statistics:":"Num rows: 17795 Data size: 142360 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"RS_160","outputname:":"Reducer 3","outputOperator:":["GBY_165"]}}}}}}}},{"Filter Operator":{"predicate:":"((ss_store_sk = 410) and ss_hdemo_sk is null) (type: boolean)","Statistics:":"Num rows: 3863598 Data size: 61107128 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"FIL_161","children":{"Select Operator":{"Statistics:":"Num rows: 3863598 Data size: 61107128 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_162","children":{"Group By Operator":{"keys:":"410 (type: bigint)","mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 17795 Data size: 142360 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_163","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: bigint)","sort order:":"+","Map-reduce partition columns:":"_col0 (type: bigint)","Statistics:":"Num rows: 17795 Data size: 142360 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"RS_164","outputname:":"Reducer 8","outputOperator:":["GBY_192"]}}}}}}}}]}}],"Execution mode:":"vectorized, llap","LLAP IO:":"all inputs"},"Reducer 10":{"Execution mode:":"llap","Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{},"outputColumnNames:":["_col1","_col2","_col3"],"Statistics:":"Num rows: 379 Data size: 9096 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"MERGEJOIN_149","children":{"Filter Operator":{"predicate:":"(_col3 > (0.9 * _col1)) (type: boolean)","Statistics:":"Num rows: 126 Data size: 3024 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"FIL_86","children":{"Reduce Output Operator":{"key expressions:":"0 (type: int), _col3 (type: double)","sort order:":"+-","Map-reduce partition columns:":"0 (type: int)","Statistics:":"Num rows: 126 Data size: 3024 Basic stats: COMPLETE Column stats: PARTIAL","TopN Hash Memory Usage:":"0.04","value expressions:":"_col2 (type: bigint)","OperatorId:":"RS_87","outputname:":"Reducer 11","outputOperator:":["SEL_88"]}}}}}}},"Reducer 11":{"Execution mode:":"llap","Reduce Operator Tree:":{"Select Operator":{"expressions:":"VALUE._col2 (type: bigint), KEY.reducesinkkey1 (type: double)","outputColumnNames:":["_col2","_col3"],"Statistics:":"Num rows: 126 Data size: 2016 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_88","children":{"PTF Operator":{"Function definitions:":[{"Input definition":{"input alias:":"ptf_0","output shape:":"_col2: bigint, _col3: double","type:":"WINDOWING"}},{"Windowing table definition":{"input alias:":"ptf_1","name:":"windowingtablefunction","order by:":"_col3 DESC NULLS LAST","partition by:":"0","window functions:":[{"window function definition":{"alias:":"rank_window_0","arguments:":"_col3","name:":"rank","window function:":"GenericUDAFRankEvaluator","window frame:":"PRECEDING(MAX)~FOLLOWING(MAX)","isPivotResult:":"true"}}]}}],"Statistics:":"Num rows: 126 Data size: 2016 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"PTF_89","children":{"Filter Operator":{"predicate:":"((rank_window_0 < 11) and _col2 is not null) (type: boolean)","Statistics:":"Num rows: 42 Data size: 672 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"FIL_131","children":{"Select Operator":{"expressions:":"_col2 (type: bigint), rank_window_0 (type: int)","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 42 Data size: 504 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_90","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col0 (type: bigint)","1":"_col0 (type: bigint)"},"outputColumnNames:":["_col1","_col3"],"input vertices:":{"0":"Map 1"},"Statistics:":"Num rows: 42 Data size: 4662 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"MAPJOIN_150","children":{"Reduce Output Operator":{"key expressions:":"_col3 (type: int)","sort order:":"+","Map-reduce partition columns:":"_col3 (type: int)","Statistics:":"Num rows: 42 Data size: 4662 Basic stats: COMPLETE Column stats: PARTIAL","value expressions:":"_col1 (type: string)","OperatorId:":"RS_102","outputname:":"Reducer 6","outputOperator:":["SEL_41"]}}}}}}}}}}}}},"Reducer 13":{"Execution mode:":"llap","Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["avg(VALUE._col0)"],"keys:":"KEY._col0 (type: bigint)","mode:":"mergepartial","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_24","children":{"Select Operator":{"expressions:":"_col1 (type: double)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_25","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","value expressions:":"_col0 (type: double)","OperatorId:":"RS_34","outputname:":"Reducer 4","outputOperator:":["GBY_175"]}}}}}}},"Reducer 14":{"Execution mode:":"llap","Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["avg(VALUE._col0)"],"keys:":"KEY._col0 (type: bigint)","mode:":"mergepartial","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_71","children":{"Select Operator":{"expressions:":"_col1 (type: double)","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_72","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","value expressions:":"_col0 (type: double)","OperatorId:":"RS_81","outputname:":"Reducer 9","outputOperator:":["GBY_196"]}}}}}}},"Reducer 16":{"Execution mode:":"llap","Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["avg(VALUE._col0)"],"keys:":"KEY._col0 (type: bigint)","mode:":"mergepartial","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 379 Data size: 6064 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_31","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 379 Data size: 6064 Basic stats: COMPLETE Column stats: PARTIAL","value expressions:":"_col0 (type: bigint), _col1 (type: double)","OperatorId:":"RS_37","outputname:":"Reducer 5","outputOperator:":["MERGEJOIN_146"]}}}}},"Reducer 17":{"Execution mode:":"llap","Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["avg(VALUE._col0)"],"keys:":"KEY._col0 (type: bigint)","mode:":"mergepartial","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 379 Data size: 6064 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_78","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 379 Data size: 6064 Basic stats: COMPLETE Column stats: PARTIAL","value expressions:":"_col0 (type: bigint), _col1 (type: double)","OperatorId:":"RS_84","outputname:":"Reducer 10","outputOperator:":["MERGEJOIN_149"]}}}}},"Reducer 3":{"Execution mode:":"vectorized, llap","Reduce Operator Tree:":{"Group By Operator":{"keys:":"KEY._col0 (type: bigint)","mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_165","children":{"Select Operator":{"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_166","children":{"Group By Operator":{"aggregations:":["count()"],"mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_167","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","value expressions:":"_col0 (type: bigint)","OperatorId:":"RS_168","outputname:":"Reducer 4","outputOperator:":["GBY_175"]}}}}}}}}},"Reducer 4":{"Execution mode:":"vectorized, llap","Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["count(VALUE._col0)"],"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_175","children":{"Filter Operator":{"predicate:":"(sq_count_check(_col0) <= 1) (type: boolean)","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"FIL_176","children":{"Select Operator":{"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_177","children":{"Map Join Operator":{"condition map:":[{"":"Left Outer Join0 to 1"}],"keys:":{},"outputColumnNames:":["_col1"],"input vertices:":{"1":"Reducer 13"},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"MAPJOIN_178","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","value expressions:":"_col1 (type: double)","OperatorId:":"RS_179","outputname:":"Reducer 5","outputOperator:":["MERGEJOIN_146"]}}}}}}}}}}},"Reducer 5":{"Execution mode:":"llap","Reduce Operator Tree:":{"Merge Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{},"outputColumnNames:":["_col1","_col2","_col3"],"Statistics:":"Num rows: 379 Data size: 9096 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"MERGEJOIN_146","children":{"Filter Operator":{"predicate:":"(_col3 > (0.9 * _col1)) (type: boolean)","Statistics:":"Num rows: 126 Data size: 3024 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"FIL_39","children":{"Reduce Output Operator":{"key expressions:":"0 (type: int), _col3 (type: double)","sort order:":"++","Map-reduce partition columns:":"0 (type: int)","Statistics:":"Num rows: 126 Data size: 3024 Basic stats: COMPLETE Column stats: PARTIAL","TopN Hash Memory Usage:":"0.04","value expressions:":"_col2 (type: bigint)","OperatorId:":"RS_40","outputname:":"Reducer 6","outputOperator:":["SEL_41"]}}}}}}},"Reducer 6":{"Execution mode:":"llap","Reduce Operator Tree:":{"Select Operator":{"expressions:":"VALUE._col2 (type: bigint), KEY.reducesinkkey1 (type: double)","outputColumnNames:":["_col2","_col3"],"Statistics:":"Num rows: 126 Data size: 2016 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_41","children":{"PTF Operator":{"Function definitions:":[{"Input definition":{"input alias:":"ptf_0","output shape:":"_col2: bigint, _col3: double","type:":"WINDOWING"}},{"Windowing table definition":{"input alias:":"ptf_1","name:":"windowingtablefunction","order by:":"_col3 ASC NULLS FIRST","partition by:":"0","window functions:":[{"window function definition":{"alias:":"rank_window_0","arguments:":"_col3","name:":"rank","window function:":"GenericUDAFRankEvaluator","window frame:":"PRECEDING(MAX)~FOLLOWING(MAX)","isPivotResult:":"true"}}]}}],"Statistics:":"Num rows: 126 Data size: 2016 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"PTF_42","children":{"Filter Operator":{"predicate:":"((rank_window_0 < 11) and _col2 is not null) (type: boolean)","Statistics:":"Num rows: 42 Data size: 672 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"FIL_126","children":{"Select Operator":{"expressions:":"_col2 (type: bigint), rank_window_0 (type: int)","outputColumnNames:":["_col0","_col1"],"Statistics:":"Num rows: 42 Data size: 504 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_43","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col0 (type: bigint)","1":"_col0 (type: bigint)"},"outputColumnNames:":["_col1","_col3"],"input vertices:":{"0":"Map 1"},"Statistics:":"Num rows: 42 Data size: 4662 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"MAPJOIN_147","children":{"Map Join Operator":{"condition map:":[{"":"Inner Join 0 to 1"}],"keys:":{"0":"_col3 (type: int)","1":"_col3 (type: int)"},"outputColumnNames:":["_col1","_col3","_col5"],"input vertices:":{"1":"Reducer 11"},"Statistics:":"Num rows: 42 Data size: 9156 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"MAPJOIN_151","children":{"Select Operator":{"expressions:":"_col3 (type: int), _col1 (type: string), _col5 (type: string)","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 42 Data size: 9156 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_104","children":{"Reduce Output Operator":{"key expressions:":"_col0 (type: int)","sort order:":"+","Statistics:":"Num rows: 42 Data size: 9156 Basic stats: COMPLETE Column stats: PARTIAL","TopN Hash Memory Usage:":"0.04","value expressions:":"_col1 (type: string), _col2 (type: string)","OperatorId:":"RS_105","outputname:":"Reducer 7","outputOperator:":["SEL_201"]}}}}}}}}}}}}}}}}},"Reducer 7":{"Execution mode:":"vectorized, llap","Reduce Operator Tree:":{"Select Operator":{"expressions:":"KEY.reducesinkkey0 (type: int), VALUE._col0 (type: string), VALUE._col1 (type: string)","outputColumnNames:":["_col0","_col1","_col2"],"Statistics:":"Num rows: 42 Data size: 9156 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_201","children":{"Limit":{"Number of rows:":"100","Statistics:":"Num rows: 42 Data size: 9156 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"LIM_202","children":{"File Output Operator":{"compressed:":"false","Statistics:":"Num rows: 42 Data size: 9156 Basic stats: COMPLETE Column stats: PARTIAL","table:":{"input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat","serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"},"OperatorId:":"FS_203"}}}}}}},"Reducer 8":{"Execution mode:":"vectorized, llap","Reduce Operator Tree:":{"Group By Operator":{"keys:":"KEY._col0 (type: bigint)","mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_192","children":{"Select Operator":{"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_193","children":{"Group By Operator":{"aggregations:":["count()"],"mode:":"hash","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_194","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","value expressions:":"_col0 (type: bigint)","OperatorId:":"RS_195","outputname:":"Reducer 9","outputOperator:":["GBY_196"]}}}}}}}}},"Reducer 9":{"Execution mode:":"vectorized, llap","Reduce Operator Tree:":{"Group By Operator":{"aggregations:":["count(VALUE._col0)"],"mode:":"mergepartial","outputColumnNames:":["_col0"],"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"GBY_196","children":{"Filter Operator":{"predicate:":"(sq_count_check(_col0) <= 1) (type: boolean)","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"FIL_197","children":{"Select Operator":{"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"SEL_198","children":{"Map Join Operator":{"condition map:":[{"":"Left Outer Join0 to 1"}],"keys:":{},"outputColumnNames:":["_col1"],"input vertices:":{"1":"Reducer 14"},"Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","OperatorId:":"MAPJOIN_199","children":{"Reduce Output Operator":{"sort order:":"","Statistics:":"Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: PARTIAL","value expressions:":"_col1 (type: double)","OperatorId:":"RS_200","outputname:":"Reducer 10","outputOperator:":["MERGEJOIN_149"]}}}}}}}}}}}}}},"Stage-0":{"Fetch Operator":{"limit:":"100","Processor Tree:":{"ListSink":{"OperatorId:":"LIST_SINK_204"}}}}}}